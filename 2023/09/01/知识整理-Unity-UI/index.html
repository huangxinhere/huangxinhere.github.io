<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Unity-UI | Hx's blog</title><meta name="author" content="(â—Ë‡âˆ€Ë‡â—),1159390360@qq.com"><meta name="copyright" content="(â—Ë‡âˆ€Ë‡â—)"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="UIéƒ¨åˆ†">
<meta property="og:type" content="article">
<meta property="og:title" content="Unity-UI">
<meta property="og:url" content="https://huangxinhere.github.io/2023/09/01/%E7%9F%A5%E8%AF%86%E6%95%B4%E7%90%86-Unity-UI/index.html">
<meta property="og:site_name" content="Hx&#39;s blog">
<meta property="og:description" content="UIéƒ¨åˆ†">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://huangxinhere.github.io/img/unity.jpg">
<meta property="article:published_time" content="2023-08-31T16:00:00.000Z">
<meta property="article:modified_time" content="2025-06-23T07:38:22.497Z">
<meta property="article:author" content="(â—Ë‡âˆ€Ë‡â—)">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://huangxinhere.github.io/img/unity.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Unity-UI",
  "url": "https://huangxinhere.github.io/2023/09/01/%E7%9F%A5%E8%AF%86%E6%95%B4%E7%90%86-Unity-UI/",
  "image": "https://huangxinhere.github.io/img/unity.jpg",
  "datePublished": "2023-08-31T16:00:00.000Z",
  "dateModified": "2025-06-23T07:38:22.497Z",
  "author": [
    {
      "@type": "Person",
      "name": "(â—Ë‡âˆ€Ë‡â—)",
      "url": "https://huangxinhere.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://huangxinhere.github.io/2023/09/01/%E7%9F%A5%E8%AF%86%E6%95%B4%E7%90%86-Unity-UI/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶å¤±è´¥',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'åŠ è½½æ›´å¤š'
  },
  isPhotoFigcaption: true,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Unity-UI',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="Hx's blog" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/head_pic_3.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">50</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">9</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/unity.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Hx's blog</span></a><a class="nav-page-title" href="/"><span class="site-name">Unity-UI</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  è¿”å›é¦–é¡µ</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Unity-UI</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-08-31T16:00:00.000Z" title="å‘è¡¨äº 2023-09-01 00:00:00">2023-09-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2025-06-23T07:38:22.497Z" title="æ›´æ–°äº 2025-06-23 15:38:22">2025-06-23</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%9F%A5%E8%AF%86%E7%82%B9%E6%A2%B3%E7%90%86/">çŸ¥è¯†ç‚¹æ¢³ç†</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">æµè§ˆé‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p><a target="_blank" rel="noopener" href="https://docs.unity.cn/cn/current/Manual/UICanvas.html">ç”»å¸ƒ - Unity æ‰‹å†Œ</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.unity.cn/2021.3/Documentation/Manual/UICanvas.html">Unity - Manual: Canvas</a></p>
<p>Unityå†…ç½®çš„UIç»„ä»¶è¿˜æœ‰ UI Toolkitã€å³æ—¶æ¨¡å¼IMGUIï¼Œç°åœ¨ä¸»è¦ç”¨çš„æ˜¯UnityUIã€‚</p>
<h1 id="Canvas"><a href="#Canvas" class="headerlink" title="Canvas"></a>Canvas</h1><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/SGamble/article/details/100658008">Unity Canvas è¯¦è§£_TravelerTDçš„åšå®¢-CSDNåšå®¢</a>ã€ç»„ä»¶æ›´è¯¦ç»†çš„è¯´æ˜ã€‘</p>
<p><strong>ç”»å¸ƒ (Canvas)</strong> æ˜¯åº”è¯¥å®¹çº³æ‰€æœ‰ UI å…ƒç´ çš„åŒºåŸŸã€‚ç”»å¸ƒæ˜¯ä¸€ç§å¸¦æœ‰ç”»å¸ƒç»„ä»¶çš„æ¸¸æˆå¯¹è±¡ï¼Œæ‰€æœ‰ UI å…ƒç´ éƒ½å¿…é¡»æ˜¯æ­¤ç±»ç”»å¸ƒçš„å­é¡¹ã€‚</p>
<h2 id="ç»˜åˆ¶å…ƒç´ é¡ºåº"><a href="#ç»˜åˆ¶å…ƒç´ é¡ºåº" class="headerlink" title="ç»˜åˆ¶å…ƒç´ é¡ºåº"></a>ç»˜åˆ¶å…ƒç´ é¡ºåº</h2><p>ç”»å¸ƒä¸­çš„ UI å…ƒç´ æŒ‰ç…§å®ƒä»¬åœ¨ Hierarchy ä¸­æ˜¾ç¤ºçš„é¡ºåºç»˜åˆ¶ã€‚ä¹Ÿå¯ä»¥é€šè¿‡åœ¨å˜æ¢ç»„ä»¶ä¸Šä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ä»è„šæœ¬æ§åˆ¶é¡ºåºï¼šSetAsFirstSiblingã€SetAsLastSibling å’Œ SetSiblingIndexã€‚</p>
<h2 id="æ¸²æŸ“æ¨¡å¼-Render-Modes"><a href="#æ¸²æŸ“æ¨¡å¼-Render-Modes" class="headerlink" title="æ¸²æŸ“æ¨¡å¼ Render Modes"></a>æ¸²æŸ“æ¨¡å¼ Render Modes</h2><ul>
<li><p>Screen Space - Overlay</p>
<p>æ­¤æ¸²æŸ“æ¨¡å¼å°† UI å…ƒç´ æ”¾ç½®äºåœ¨åœºæ™¯ä¹‹ä¸Šæ¸²æŸ“çš„å±å¹•ä¸Šã€‚å¦‚æœè°ƒæ•´å±å¹•å¤§å°æˆ–æ›´æ”¹åˆ†è¾¨ç‡ï¼Œåˆ™ç”»å¸ƒå°†è‡ªåŠ¨æ›´æ”¹å¤§å°æ¥é€‚åº”æ­¤æƒ…å†µã€‚</p>
</li>
<li><p>Screen Space - Camera</p>
<p>ç”»å¸ƒæ”¾ç½®åœ¨æŒ‡å®š__æ‘„åƒæœº__å‰é¢çš„ç»™å®šè·ç¦»å¤„ã€‚UI å…ƒç´ ç”±æ­¤æ‘„åƒæœºæ¸²æŸ“ï¼Œè¿™æ„å‘³ç€æ‘„åƒæœºè®¾ç½®ä¼šå½±å“ UI çš„å¤–è§‚ã€‚å¦‚æœè°ƒæ•´å±å¹•å¤§å°ã€æ›´æ”¹åˆ†è¾¨ç‡æˆ–æ‘„åƒæœºè§†é”¥ä½“å‘ç”Ÿæ”¹å˜ï¼Œåˆ™ç”»å¸ƒä¹Ÿå°†è‡ªåŠ¨æ›´æ”¹å¤§å°æ¥é€‚åº”æ­¤æƒ…å†µã€‚</p>
</li>
<li><p>World Space</p>
<p>ç”»å¸ƒçš„è¡Œä¸ºä¸åœºæ™¯ä¸­çš„æ‰€æœ‰å…¶ä»–å¯¹è±¡ç›¸åŒã€‚ç”»å¸ƒå¤§å°å¯ç”¨çŸ©å½¢å˜æ¢è¿›è¡Œæ‰‹åŠ¨è®¾ç½®ï¼Œè€Œ UI å…ƒç´ å°†åŸºäº 3D ä½ç½®åœ¨åœºæ™¯ä¸­çš„å…¶ä»–å¯¹è±¡å‰é¢æˆ–åé¢æ¸²æŸ“ã€‚æ­¤æ¨¡å¼å¯¹äºè¦æˆä¸ºä¸–ç•Œä¸€éƒ¨åˆ†çš„ UI éå¸¸æœ‰ç”¨ã€‚è¿™ç§ç•Œé¢ä¹Ÿç§°ä¸ºâ€œå™äº‹ç•Œé¢â€ã€‚</p>
</li>
</ul>
<h1 id="UGUIå’ŒNGUIçš„åŒºåˆ«"><a href="#UGUIå’ŒNGUIçš„åŒºåˆ«" class="headerlink" title="UGUIå’ŒNGUIçš„åŒºåˆ«"></a>UGUIå’ŒNGUIçš„åŒºåˆ«</h1><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/5891e28aa766">ä»€ä¹ˆæ˜¯UI?unityä¸­NGUIä¸UGUIçš„åŒºåˆ«ï¼Ÿ - ç®€ä¹¦ (jianshu.com)</a></p>
<p>UGUIæ˜¯å®˜æ–¹4.6ä»¥åæ¨å‡ºçš„ä¸€å¥—UIç»„ä»¶ï¼Œç›¸å¯¹äºä¹‹å‰çš„GUIå€’æ˜¯æ”¹å¤´æ¢é¢äº†ï¼Œå¯è§†åŒ–æ“ä½œï¼Œä¾¿æ·ã€çœå¿ƒã€‚NGUIåˆ™æ˜¯unityä¸€ç›´ä»¥æ¥æœ€å¼ºçš„UIæ’ä»¶ï¼ˆæ²¡æœ‰ä¹‹ä¸€ï¼‰ï¼Œç”šè‡³è¿˜æ˜¯å®˜æ–¹æ–°UIçš„å¯¼å¸ˆã€‚</p>
<p><img src="https://upload-images.jianshu.io/upload_images/4035828-aa96cf226a850983.png?imageMogr2/auto-orient/strip%7CimageView2/2/format/webp" alt="img"></p>
<p>UGUIç”±äºæ˜¯UnityåŸç”Ÿæ”¯æŒçš„ï¼Œæ‰€ä»¥ä½¿ç”¨ä¸Šä¼šæ›´åŠ çš„äººæ€§åŒ–ã€‚å¹¶ä¸”ä¼´éšç€ç‰ˆæœ¬å‡çº§åŠŸèƒ½ä¼šè¶Šæ¥è¶Šå¼ºï¼Œé€æ¸å°†æˆä¸ºä¸»æµuiæ–¹æ¡ˆã€‚NGUIæ˜¯UGUIå‡ºç°ä¹‹å‰çš„äº§ç‰©ï¼Œé€šè¿‡MeshRendereræ¥å®ç°ç±»ä¼¼CanvasRendererçš„åŠŸèƒ½ï¼Œæ¦‚å¿µä¸Šæœ‰ç‚¹è¹©è„šã€‚ä½œä¸ºä¸€ä¸ªæ’ä»¶è™½ç„¶å·²æœ€å¤§åŠªåŠ›è®©UIå¼€å‘å·¥ä½œå˜å¾—ç®€å•ï¼Œä½†ç›¸æ¯”èƒ½å¤Ÿè®©UnityEditoråšå‡ºç›¸åº”ä¿®æ”¹çš„UGUIï¼ˆå¦‚RectTransformçš„å‡ºç°ï¼‰ï¼Œå…¶æ˜“ç”¨æ€§æ˜¯æ²¡æ³•æ¯”çš„ã€‚ç»¼åˆæ¥è¯´ï¼Œæ–°çš„é¡¹ç›®å»ºè®®ä½¿ç”¨UGUIï¼Œå­¦ä¹ æˆæœ¬ä¸é«˜ï¼Œå·¥å…·æµæ›´æœ‰åŠ©äºæé«˜å¼€å‘æ•ˆç‡ã€‚</p>
<h1 id="UGUIåŸç†"><a href="#UGUIåŸç†" class="headerlink" title="UGUIåŸç†"></a>UGUIåŸç†</h1><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV17W4y1d7dY?p=7&vd_source=bd424a1eb707161ee6ba2f47e4c49a08">7.Graphicå®¶æ—_å“”å“©å“”å“©_bilibili</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/340601785">UGUIæºç è§£æï¼ˆäºŒåä¸ƒï¼‰æ€»ç»“ç¯‡ - çŸ¥ä¹ (zhihu.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/343524911">UGUIæ·±å…¥ç†è§£â€“æ¸²æŸ“ç³»ç»Ÿ - çŸ¥ä¹ (zhihu.com)</a></p>
<p>ç”±è‡ªå®ç°çš„ä¾‹å­å¯çŸ¥ï¼Œæ ¸å¿ƒåŠŸèƒ½æ˜¯<strong>UIæ˜¾ç¤º</strong>ï¼ˆç”±meshæ„å»ºä¿å­˜åˆ°meshFilterå¹¶ç”±meshRenderæ¸²æŸ“ï¼šè¿™ä¸€ç³»åˆ—æ“ä½œæ˜¯å¿…é¡»æ¯å¸§æ›´æ–°é‡æ–°ç»˜åˆ¶ï¼Ÿï¼‰å’Œ<strong>å°„çº¿æ£€æµ‹ç‚¹å‡»</strong>ï¼ˆinputå‘å°„å°„çº¿ï¼Œå¹¶ä¸”åœ¨meshæ·»åŠ ç¢°æ’å™¨æ¥æ¥æ”¶ï¼‰ã€‚</p>
<h2 id="å›¾å½¢ç»˜åˆ¶"><a href="#å›¾å½¢ç»˜åˆ¶" class="headerlink" title="å›¾å½¢ç»˜åˆ¶"></a>å›¾å½¢ç»˜åˆ¶</h2><ul>
<li>åŸºç¡€</li>
</ul>
<p>æ ¸å¿ƒæ¦‚å¿µï¼šMeshã€Vertexã€Triangleã€UVï¼›</p>
<p>Vertexï¼šé¡¶ç‚¹ï¼Œç»„æˆMeshçš„å…ƒç´ ï¼›</p>
<p>Triangleï¼šä¸‰è§’å½¢ï¼Œå†³å®šé¡¶ç‚¹é¡ºåºï¼›ï¼ˆä¼¸å‡ºå·¦æ‰‹ï¼Œæ‹‡æŒ‡ç¯ç»•æœå‘ä¹Ÿå°±æ˜¯é¡ºæ—¶é’ˆçš„ä¸€é¢å°±æ˜¯æ­£é¢ï¼‰</p>
<p>Meshï¼šç½‘æ ¼ï¼Œå†³å®šç‰©ä½“çš„å½¢çŠ¶ï¼›</p>
<p>UVï¼šçº¹ç†è´´å›¾åæ ‡ï¼›å®šä¹‰æ¨¡å‹ä¸­çš„ä½ç½®ä¸è´´å›¾ä¹‹é—´çš„ä½ç½®å…³ç³»ã€‚</p>
<p><img src="/2023/09/01/%E7%9F%A5%E8%AF%86%E6%95%B4%E7%90%86-Unity-UI/hexo_github_blog\source_posts\çŸ¥è¯†æ•´ç†-Unity-UI.assets\image-20230901111459137.png" alt="image-20230901111459137"></p>
<ul>
<li><p>ç›¸å…³ç±»ä»¥åŠç»“æ„</p>
<p><img src="https://pic1.zhimg.com/80/v2-57d6b7f491b04ebbc6189a3dfbec6c20_720w.webp" alt="img"></p>
</li>
<li><p>å¤§è‡´æµç¨‹ï¼š</p>
</li>
<li><p>UIç»„ä»¶çš„åŸºç±»æ˜¯<strong>Graphic</strong>ï¼ŒGraphicæ ¸å¿ƒåŠŸèƒ½æ˜¯ç»„ç»‡meshå’Œmaterialç„¶åä¼ ç»™åº•å±‚ï¼Œä¹Ÿå°±æ˜¯CanvasRendererç±»ã€‚</p>
</li>
<li><p><strong>CanvasRenderer</strong>è¿æ¥ç”»å¸ƒå’Œæ¸²æŸ“ç»„ä»¶ï¼Œé€šè¿‡CanvasRendereræŠŠ<u>ç½‘æ ¼ç»˜åˆ¶åˆ°Canvasä¸Š</u>ï¼ŒCRå¹¶ä¸æ˜¯ç›´æ¥æ¸²æŸ“ï¼Œè€Œæ˜¯äº¤ç»™Canvasï¼ŒCanvasè¿˜è¦åšåˆæ‰¹ç­‰æ“ä½œï¼›</p>
<p>CanvasRendererè¿™ä¸ªåå­—æœ‰ç‚¹è¯¯å¯¼ï¼Œå¹¶ä¸æ˜¯å¯¹åº”Canvasï¼Œè€Œæ˜¯å¯¹åº”Graphicã€‚é‡è¦çš„æ¥å£æœ‰ä¸¤ä¸ªï¼ŒSetMeshå’ŒSetMaterialã€‚ä¸€æ¬¡è®¾ç½®åï¼Œå¦‚æœæ²¡æœ‰æ”¹å˜ï¼Œä¸éœ€è¦é‡å¤è®¾ç½®ï¼Œåº•å±‚æœ‰ç¼“å­˜ï¼Œmeshå’Œmaterialå¯ä»¥åˆ†å¼€è®¾ç½®ã€‚</p>
<p>æ¯ä¸ªGraphicçš„CanvasRendererä¿å­˜äº†å½“å‰å…ƒç´ çš„meshå’Œmaterialï¼Œä½†å¹¶ä¸ä¼šæ¯ä¸ªGraphicä¸€ä¸ªdrawcallï¼Œcanvasä¼šå¯¹èŠ‚ç‚¹ä¸‹çš„Graphicè¿›è¡Œåˆæ‰¹ï¼Œæ‰€ä»¥ä¸€ä¸ªGraphicè®¾ç½®dirtyï¼Œæ•´ä¸ªcanvaséƒ½éœ€è¦é‡æ–°è®¡ç®—åˆæ‰¹ï¼Œè¿™ä¸ªæ¶ˆè€—æ˜¯æ¯”è¾ƒå¤§çš„ï¼Œåˆç†åˆ†é…canvasï¼Œå¯¹æ€§èƒ½å½±å“è¾ƒå¤§ï¼Œè¿™æ˜¯ç•Œé¢æ¸²æŸ“æ€§èƒ½è¦æ³¨æ„çš„åœ°æ–¹ã€‚</p>
</li>
<li><p>CanvasUpdateRegistryè´Ÿè´£<strong>é©±åŠ¨</strong>ï¼Œä¹Ÿå°±æ˜¯é€šçŸ¥éœ€è¦æ¸²æŸ“çš„UIç»„ä»¶ã€‚</p>
<p>é‚£ä¸ºä»€ä¹ˆç”¨é€šçŸ¥çš„æ–¹å¼è€Œä¸æ˜¯UIè‡ªå·±å¤„ç†å‘¢ï¼Œ</p>
<p>UGUIçš„å¤„ç†æµç¨‹ï¼šUIè‡ªå·±è®°å½•æ˜¯å¦éœ€è¦é‡æ–°æ¸²æŸ“ï¼Œæ³¨å†Œäº‹ä»¶ç»™registryï¼Œregistryåœ¨è¦æ¸²æŸ“çš„æ—¶å€™è§¦å‘äº‹ä»¶ï¼ŒUIå†å»æäº¤æ•°æ®ã€‚</p>
<p>è¿™æ ·çš„å¥½å¤„æ˜¯ï¼Œé¦–å…ˆUI<strong>å„ç§æ•°æ®ä¼šåœ¨ä¸€å¸§å†…å¤šæ¬¡æ”¹å˜</strong>ï¼Œè‚¯å®šä¸èƒ½æ¯æ¬¡æ”¹å˜éƒ½å‘æ¸²æŸ“äº‹ä»¶ï¼Œ<strong>ä¸€å¸§å¤„ç†ä¸€æ¬¡æ•ˆç‡æ¯”è¾ƒé«˜</strong>ã€‚å†ä¸€ä¸ªå¦‚æœä¸å‘äº‹ä»¶ï¼Œé‚£å°±å¿…ç„¶è¦åœ¨updateé‡Œå†™é€»è¾‘ï¼Œæ¯”ç»Ÿä¸€äº‹ä»¶è¦éº»çƒ¦äº›ã€‚</p>
</li>
</ul>
<blockquote>
<p>å†å›æƒ³ä»¥ä¸‹è‡ªå®šä¹‰Imageçš„ä¾‹å­æ¥ç†è§£ï¼Œè‡ªå·±å®ç°Imageæ¸²æŸ“çš„æ—¶å€™ï¼Œæ˜¯åœ¨Updateé‡Œé¢è°ƒç”¨æ„å»ºmeshå’Œæ¸²æŸ“çš„æ–¹æ³•ï¼›è€Œåœ¨UGUIé‡Œé¢ï¼ŒUIè‡ªå·±è®°å½•æ˜¯å¦éœ€è¦é‡æ–°æ¸²æŸ“ï¼Œæ³¨å†Œäº‹ä»¶ç»™registryï¼Œregistryåœ¨è¦æ¸²æŸ“çš„æ—¶å€™è§¦å‘äº‹ä»¶ï¼ŒUIå†å»æ›´æ–°ã€‚ï¼ˆå¾€ä¸‹çš„é‡ç»˜è¿‡ç¨‹æœ‰è¯¦ç»†è¯´æ˜ï¼‰</p>
</blockquote>
<p>ä¸€å¥è¯æ€»ç»“å›¾å½¢ç»˜åˆ¶ï¼šæ­£å¸¸ç»˜åˆ¶å’Œé‡æ–°ç»˜åˆ¶ï¼Œç»˜åˆ¶æ ¸å¿ƒæ˜¯ç½‘æ ¼å’Œæ¸²æŸ“ï¼Œç½‘æ ¼åŠæ¸²æŸ“ä¿¡æ¯ç”±CanvasRendererå¤„ç†ç»™Canvasåšåˆæ‰¹ï¼Œé‡æ–°ç»˜åˆ¶åˆ™å’ŒCanvasUpdateRegistryç›¸å…³ã€‚ã€å¾…æ‰“ç£¨ã€‘</p>
<h2 id="åŸºç¡€ç±»è¯¦è§£"><a href="#åŸºç¡€ç±»è¯¦è§£" class="headerlink" title="åŸºç¡€ç±»è¯¦è§£"></a>åŸºç¡€ç±»è¯¦è§£</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/VR_iShow/article/details/92850381">ã€Unity&#x2F;ç¬”è®°ã€‘UGUIåŸºç¡€åŸç†__iShow_çš„åšå®¢-CSDNåšå®¢</a></p>
<ul>
<li><p><strong>Graphic[å›¾å½¢]</strong><br><code>[RequireComponent(typeof(CanvasRenderer))]</code><br><code>[RequireComponent(typeof(RectTransform))]</code></p>
<blockquote>
<p>ç”±Unity UIç³»ç»Ÿçš„C#åº“æä¾›çš„åŸºç±»ï¼Œæ‰€æœ‰çš„<u>å‘ç”»å¸ƒç³»ç»Ÿæä¾›å¯ç»˜åˆ¶å‡ ä½•å†…å®¹</u>çš„UIç³»ç»ŸC#ç±»éƒ½ç»§æ‰¿å®ƒã€‚</p>
<p>å¤§å¤šæ•°å†…ç½®çš„UIç³»ç»Ÿç»˜å›¾ç±»éƒ½æ˜¯é€šè¿‡ <u>MaskableGraphic å­ç±»</u>å®ç°çš„ï¼Œè¿™ä¸ªå­ç±»å®ç°äº† IMaskable æ¥å£ï¼Œ<u>å¯ä»¥è¢«é®ç½©</u>ã€‚</p>
<p>Drawableç±»çš„ä¸»è¦å­ç±»æ˜¯ Image å’Œ Text ï¼Œå®ƒä»¬èƒ½æä¾›ä¸å…¶åç§°ç›¸å¯¹åº”çš„å†…å®¹ã€‚</p>
</blockquote>
<p>Graphicæ˜¯UGUIçš„å›¾å½¢åŠŸèƒ½åŸºç±»,å®ƒå¿…é¡»ä¾èµ–CanvasRendererä¸RectTransform ç»„ä»¶è¿è¡Œã€‚</p>
<p>å†…ç½®UIç³»ç»Ÿé€šè¿‡MaskableGraphicå®ç°ï¼Œä½¿ç”¨äº†IMaskabelæ¥å£ï¼Œå¯è¢«é®ç½©ã€‚<br>Textå’ŒImageéƒ½ç»§æ‰¿è‡ªMaskableGraphic, ILayoutElement(åŠå…¶ä»–)</p>
</li>
<li><p><strong>Layout[å¸ƒå±€]</strong><br><code>[RequireComponent(typeof(RectTransform))]</code></p>
<blockquote>
<p>Layoutç»„ä»¶(å¦‚ScrollRect)<u>æ§åˆ¶RectTransformçš„å°ºå¯¸å’Œä½ç½®</u>ï¼Œå®ƒé€šå¸¸ç”¨äºåˆ›å»ºå…·æœ‰å¤æ‚å¸ƒå±€ã€å¹¶ä¸”å†…éƒ¨ç»„ä»¶éœ€è¦ç›¸å¯¹å°ºå¯¸ã€æˆ–è€…ç›¸å¯¹ä½ç½®çš„UIã€‚</p>
<p>Layoutç»„ä»¶åªä¾èµ–RectTransformå¹¶ä¸”<u>åªå½±å“ä¸å…¶å…³è”çš„RectTransform</u>çš„å±æ€§ã€‚ä»–ä»¬ä¸ä¾èµ–Graphicç±»ï¼Œå¹¶ä¸”å¯ä»¥ç‹¬ç«‹äºUIç³»ç»Ÿçš„Graphicç±»ä½¿ç”¨ã€‚</p>
</blockquote>
</li>
<li><p><strong>Canvas[ç”»å¸ƒ]</strong></p>
<blockquote>
<p>ç”»å¸ƒ(Canvas) æ˜¯ä»¥åŸç”Ÿä»£ç ç¼–å†™çš„Unityç»„ä»¶ï¼Œç”»å¸ƒè´Ÿè´£<u>å°†å…¶å†…éƒ¨çš„å‡ ä½•å½¢çŠ¶åˆå¹¶åˆ°æ‰¹å¤„ç†ã€ç”Ÿæˆåˆé€‚çš„æ¸²æŸ“æŒ‡ä»¤å¹¶å‘é€åˆ°Unityå›¾å½¢ç³»ç»Ÿ</u>ã€‚</p>
<p>è¿™äº›æ“ä½œéƒ½<u>ç”±åŸç”ŸC++ä»£ç </u>å®Œæˆï¼Œè¿™è¢«ç§°ä¸º é‡æ–°æ‰¹å¤„ç†(rebatch) æˆ– æ‰¹å¤„ç†æ„å»º(batch build) ã€‚å½“ä¸€ä¸ªç”»å¸ƒè¢«æ ‡è®°ä¸ºå«æœ‰éœ€è¦é‡æ–°æ‰¹å¤„ç†çš„å‡ ä½•å½¢çŠ¶æ—¶ï¼Œç§°è¿™ä¸ªç”»å¸ƒä¸º è„ç”»å¸ƒã€‚</p>
</blockquote>
<ol>
<li>å‡ ä½•å½¢çŠ¶æ˜¯ç”± CanvasRenderer ç»„ä»¶å‘ç”»å¸ƒæä¾›ï¼›</li>
<li>æ‰¹å¤„ç†å°±æ˜¯æŠŠ<u>ç¬¦åˆæ¡ä»¶çš„UIå…ƒç´ </u>æ‰“åŒ…æˆä¸€æ‰¹è®©GPU<u>ä¸€æ¬¡æ€§</u>çš„æŠŠä»–ä»¬ç»˜åˆ¶å‡ºæ¥ï¼›</li>
<li>ä»APIè°ƒç”¨çš„è§’åº¦æ¥çœ‹ï¼ŒBatchå’ŒDraw callæ˜¯ç­‰ä»·çš„ï¼Œä½†æ˜¯åœ¨æ¸¸æˆå¼•æ“ä¸­ä»–ä»¬çš„å®é™…æ„ä¹‰æ˜¯ä¸ä¸€æ ·çš„ï¼š<u>Batchä¸€èˆ¬æŒ‡ä»£ç»è¿‡æ‰“åŒ…ä¹‹åçš„Draw call</u>ã€‚</li>
<li>æ‰¹å¤„ç†éœ€è¦ç¬¦åˆä»¥ä¸‹æ¡ä»¶<ul>
<li>åœ¨åŒä¸€ä¸ªcanvasä¸‹ï¼›</li>
<li>ä½¿ç”¨åŒä¸€ä¸ªæè´¨ï¼›</li>
<li>åœ¨åŒä¸€æ—¶é—´æ¸²æŸ“ï¼›</li>
<li>RectTransformå…±é¢(æ·±åº¦ç›¸åŒ)ï¼Œä¸é‡å ï¼›</li>
<li>åœ¨åŒä¸€ä¸ªçˆ¶maskä¸‹(ä¸åŒmaskä¸‹ä¼šé€ æˆdrawcallå¢åŠ )</li>
</ul>
</li>
</ol>
</li>
<li><p><strong>Sub-Canvas</strong></p>
<blockquote>
<p>å­ç”»å¸ƒ(Sub-canvas) æ˜¯åµŒå¥—åœ¨å…¶ä»–ç”»å¸ƒç»„ä»¶å†…éƒ¨çš„ç”»å¸ƒç»„ä»¶ã€‚</p>
<p>å­ç”»å¸ƒèƒ½å¤Ÿå°†å…¶å­©å­èŠ‚ç‚¹ä¸å…¶çˆ¶ç”»å¸ƒéš”ç¦»å¼€ï¼Œä¸€ä¸ªè¢«æ ‡è®°ä¸ºè„çš„å­èŠ‚ç‚¹ä¸ä¼šè¿«ä½¿å…¶çˆ¶ç”»å¸ƒé‡æ–°æ„å»ºå‡ ä½•å†…å®¹ï¼Œåä¹‹äº¦ç„¶ã€‚</p>
<p>æœ‰å‡ ç§ç‰¹æ®Šæƒ…å†µä¼šä½¿ä¸Šè¿°æƒ…å½¢å¤±æ•ˆï¼Œæ¯”å¦‚ï¼Œæ”¹å˜çˆ¶ç”»å¸ƒå¯¼è‡´å­ç”»å¸ƒæ”¹å˜å°ºå¯¸ã€‚</p>
</blockquote>
<ol>
<li>å­ç”»å¸ƒä¹Ÿæ˜¯Canvas</li>
<li>å­ç”»å¸ƒåµŒå¥—åœ¨ä¸»ç”»å¸ƒå†…</li>
<li>ä¸€èˆ¬æƒ…å†µå­ç”»å¸ƒèƒ½<strong>éš”ç¦»</strong>è„çš„å­èŠ‚ç‚¹(ä½¿ä¸¤ä¸ªç”»å¸ƒå†…èŠ‚ç‚¹ç›¸äº’ä¸å½±å“ä½†ä»ç„¶ä¿æŒå±‚çº§å…³ç³»,ä¼˜åŒ–å‡å°‘é‡æ–°æ‰¹å¤„ç†çš„æ“ä½œ)</li>
</ol>
</li>
<li><p><strong>æ¸²æŸ“ç»†èŠ‚</strong></p>
<blockquote>
<p>ä½¿ç”¨UIæ„å»ºç•Œé¢æ—¶ï¼Œæ‰€æœ‰çš„å‡ ä½•å½¢çŠ¶éƒ½ä¼šåœ¨é€æ˜é˜Ÿåˆ—(Transparent queue)ä¸­ç»˜åˆ¶ã€‚ä»å¤šè¾¹å½¢æ …æ ¼åŒ–è€Œå¾—åˆ°çš„æ¯ä¸ªåƒç´ éƒ½ä¼šè¢«é‡‡æ ·ï¼Œå³ä½¿å®ƒä»¬è¢«å…¶ä»–ä¸é€æ˜å¤šè¾¹å½¢å®Œå…¨é®ç›–</p>
</blockquote>
<ol>
<li>ç”±UIç³»ç»Ÿç”Ÿæˆçš„å‡ ä½•å½¢çŠ¶éƒ½å¸¦æœ‰Alphaæ··åˆï¼Œä»åå‘å‰åœ°ç»˜åˆ¶</li>
<li>ä¸ç®¡æ˜¯å¦è¢«é®æŒ¡ï¼Œå‡ ä½•å½¢çŠ¶éƒ½ä¼šè¢«é‡‡æ ·ç»˜åˆ¶ã€‚</li>
</ol>
</li>
</ul>
<h2 id="åˆæ‰¹è¿‡ç¨‹ï¼ˆCanvasesï¼‰"><a href="#åˆæ‰¹è¿‡ç¨‹ï¼ˆCanvasesï¼‰" class="headerlink" title="åˆæ‰¹è¿‡ç¨‹ï¼ˆCanvasesï¼‰"></a>åˆæ‰¹è¿‡ç¨‹ï¼ˆCanvasesï¼‰</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/sinat_25415095/article/details/112388638">Unity3D UGUIç³»åˆ—ä¹‹åˆæ‰¹_uguiåˆæ‰¹_WangShadeçš„åšå®¢-CSDNåšå®¢</a>ã€åœ¨Unityé‡Œé¢é€šè¿‡é¢æ¿åˆ†æç›´è§‚çœ‹å‡ºåˆæ‰¹æ•°æ®ï¼Œéå¸¸ç›´è§‚æ¸…æ™°ã€‘</p>
<h3 id="ä»€ä¹ˆæ˜¯åˆæ‰¹"><a href="#ä»€ä¹ˆæ˜¯åˆæ‰¹" class="headerlink" title="ä»€ä¹ˆæ˜¯åˆæ‰¹"></a>ä»€ä¹ˆæ˜¯åˆæ‰¹</h3><blockquote>
<p>æˆ‘ä»¬ç»å¸¸ç”¨å¼•æ“<u>æ¯å¸§æäº¤çš„æ‰¹æ¬¡æ•°é‡</u>æ¥ä½œä¸ºè¡¡é‡<u>æ¸²æŸ“å‹åŠ›</u>çš„æŒ‡æ ‡ã€‚</p>
</blockquote>
<blockquote>
<p>åœ¨æ‰¹å¤„ç†æ„å»ºè¿‡ç¨‹ä¸­ï¼Œç”»å¸ƒ<strong>åˆå¹¶ç”¨äºè¡¨ç¤ºUIå…ƒç´ çš„ç½‘æ ¼(mesh)ï¼Œç”Ÿæˆåˆé€‚çš„æ¸²æŸ“æŒ‡ä»¤å‘é€åˆ°Unityçš„ç»˜å›¾ç®¡çº¿</strong>ã€‚</p>
<p>è¿™ä¸€è¿‡ç¨‹çš„ç»“æœä¼š<strong>è¢«ç¼“å­˜å¹¶é‡ç”¨</strong>ï¼Œ<strong>ç›´åˆ°ç”»å¸ƒè¢«æ ‡è®°ä¸ºè„ç”»å¸ƒ</strong>ã€‚è„ç”»å¸ƒä¼šåœ¨ç”»å¸ƒçš„ä»»ä¸€ç½‘æ ¼æ„æˆæˆå‘˜å‘é€æ”¹å˜æ—¶äº§ç”Ÿã€‚</p>
</blockquote>
<blockquote>
<p>ç”»å¸ƒæ‰€ä½¿ç”¨çš„ç½‘æ ¼æ˜¯ä»é™„åŠ åˆ°ç”»å¸ƒçš„CanvasRendererç»„ä»¶é›†åˆä¸­è·å–çš„ï¼Œä½†å…¶ä¸­ä¸ä¼šåŒ…æ‹¬å­ç”»å¸ƒä¸­çš„ç»„ä»¶(éš”ç¦»æ•ˆæœ)ã€‚</p>
</blockquote>
<h3 id="åˆæ‰¹çš„æ„ä¹‰"><a href="#åˆæ‰¹çš„æ„ä¹‰" class="headerlink" title="åˆæ‰¹çš„æ„ä¹‰"></a>åˆæ‰¹çš„æ„ä¹‰</h3><h3 id="åˆæ‰¹è§„åˆ™"><a href="#åˆæ‰¹è§„åˆ™" class="headerlink" title="åˆæ‰¹è§„åˆ™"></a>åˆæ‰¹è§„åˆ™</h3><blockquote>
<p>è®¡ç®—æ‰¹å¤„ç†éœ€è¦æ ¹æ®æ·±åº¦(depth)å¯¹ç½‘æ ¼è¿›è¡Œæ’åºã€æ£€æŸ¥ç½‘æ ¼çš„é‡å ã€å…±äº«æè´¨ç­‰æƒ…å†µã€‚</p>
<p>è¿™ä¸ªæ“ä½œæ˜¯å¤šçº¿ç¨‹çš„ï¼Œå› æ­¤åœ¨ä¸åŒçš„CPUæ¶æ„ä¸Šæ€§èƒ½å·®å¼‚å¾ˆå¤§ï¼Œå°¤å…¶æ˜¯åœ¨ç§»åŠ¨ç‰ˆSocèŠ¯ç‰‡ï¼ˆé€šå¸¸CPUæ ¸å¿ƒæ•°å°‘ï¼‰å’Œç°ä»£æ¡Œé¢CPUï¼ˆé€šå¸¸æœ‰4ä¸ªæˆ–æ›´å¤šæ ¸å¿ƒï¼‰ä¹‹é—´ã€‚</p>
</blockquote>
<ul>
<li><p>æ ¸å¿ƒæµç¨‹ï¼š</p>
<p>åˆå¹¶mesh(ç”±CanvasRendereré‡‡é›†,ä¸åŒ…æ‹¬å­ç”»å¸ƒä¸­ç»„ä»¶)</p>
<p> â€”&gt; å‘é€æ¸²æŸ“æŒ‡ä»¤ç»™ç»˜å›¾ç®¡çº¿(ä¼šç¼“å­˜) </p>
<p>â€”&gt;è„ç”»å¸ƒäº§ç”Ÿ(ç½‘æ ¼æˆå‘˜æ”¹å˜)</p>
<p> â€”&gt; é‡å»ºrebuild</p>
</li>
<li><p>è¯¦ç»†æµç¨‹ï¼šã€å‚è€ƒåšå®¢æœ‰ä¾‹å­è®¡ç®—ï¼Œä¼šæ›´æ˜ç™½äº›ã€‘</p>
<ol>
<li><p>æ—¢ç„¶åˆæ‰¹æ˜¯<strong>ä»¥Canvasä¸ºå•ä½</strong>ï¼Œç¬¬ä¸€æ­¥è‡ªç„¶å°±æ˜¯æŠŠæ‰€æœ‰Canvasç»™æ‰¾å‡ºæ¥ï¼Œç„¶åå‰”é™¤æ‰ä¸å¿…æ¸²æŸ“çš„Canvas(é€æ˜åº¦ä¸º0ï¼Œé•¿å®½ä¸º0ï¼Œåœ¨RectMask2Dæ§ä»¶ä¸‹ï¼Œä¸”åœ¨RectMask2Dçš„åŒºåŸŸå¤–)</p>
<blockquote>
<p>UGUIä¸­Canvasä¸‹å¯ä»¥åµŒå¥—å­Canvasï¼Œä½†æ˜¯åˆæ‰¹æ˜¯ä»¥Canvas(ä¸åŒ…å«å­Canvas)ä¸ºå•ä½çš„(å­Canvasä¼šæ˜¯å¦å¤–ä¸€ä¸ªæ‰¹æ¬¡äº†)ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œåˆæ‰¹çš„æ“ä½œæ˜¯åœ¨å­çº¿ç¨‹å®Œæˆçš„ã€‚</p>
</blockquote>
</li>
<li><p>è®¡ç®—Canvasä¸‹å„UIæ§ä»¶çš„<strong>æ·±åº¦å€¼Depth</strong>(éœ€è¦æ³¨æ„çš„æ˜¯Imageçš„å±æ€§é‡Œé¢ä¹Ÿæœ‰ä¸ªdepthï¼Œä¸¤è€…ä¸æ˜¯åŒä¸€ä¸ªä¸œè¥¿)</p>
</li>
<li><p>Depthçš„è®¡ç®—è§„åˆ™å¦‚ä¸‹ï¼š</p>
<p>æŒ‰ç…§Hierarchyä¸­<strong>ä»ä¸Šå¾€ä¸‹çš„é¡ºåº</strong>ä¾æ¬¡éå†Canvasä¸‹æ‰€æœ‰UIå…ƒç´ ï¼›</p>
<p>å¯¹äºå½“å‰çš„UIå…ƒç´ CurrentUIï¼š</p>
<p>i.å¦‚æœCurrentUIä¸æ¸²æŸ“ï¼Œåˆ™Depth &#x3D; -1<br>ii.å¦‚æœCurrentUIè¦æ¸²æŸ“ï¼Œä½†å½“å‰å±‚çº§å¾€ä¸Šå¹¶æ²¡æœ‰ä¸å…¶ä»–UIå…ƒç´ ç›¸äº¤ï¼Œåˆ™Depth &#x3D; 0<br>iii.å¦‚æœCurrentUIè¦æ¸²æŸ“ï¼Œå¾€ä¸Šåªæœ‰ä¸€ä¸ªUIå…ƒç´ (LowerUI)ä¸å…¶ç›¸äº¤ï¼Œä¸”CurrentUIä¸LowerUIå¯ä»¥åˆæ‰¹(æè´¨å’Œè´´å›¾å®Œå…¨ç›¸åŒ)ï¼Œåˆ™CurrentUI.Depth &#x3D; LowerUI.Depthï¼›</p>
<p>å¦‚æœä¸¤è€…ä¸èƒ½åˆæ‰¹ï¼ŒCurrentUI.Depth&#x3D; LowerUI.Depth + 1</p>
<p>iv.å¦‚æœCurrentUIè¦æ¸²æŸ“ï¼Œä¸‹é¢æœ‰nä¸ªå…ƒç´ ä¸å…¶ç›¸äº¤ï¼Œåˆ™æŒ‰ç…§æ­¥éª¤iiiï¼Œåˆ†åˆ«è®¡ç®—å‡ºnä¸ªDepth(Depth_1ã€Depth_2ã€Depth_3â€¦)ï¼Œç„¶åCurrentUI.Depthå–å…¶æœ€å¤§å€¼ï¼Œå³CurrentUI.Depth &#x3D; max(Depth_1, Depth_2, Depth_3ï¼Œâ€¦)</p>
<blockquote>
<p>ä¸Šé¢æ­¥éª¤ä¸­çš„â€œä¸‹é¢â€å’Œâ€œç›¸äº¤â€è¦æ˜ç¡®ä¸‹æ„æ€ï¼Œè¿™ä¸¤ä¸ªæ¦‚å¿µå¾ˆé‡è¦ã€‚</p>
<p>CurrentUIä¸‹é¢çš„UIï¼ŒæŒ‡Hierarchyé¢æ¿ä¸­ï¼Œåœ¨CurrentUIä¹‹ä¸Šçš„å…ƒç´ ã€‚</p>
<p>ä¸¤ä¸ªUIå…ƒç´ ç›¸äº¤ï¼Œæ˜¯æŒ‡è¿™ä¸¤ä¸ªå…ƒç´ çš„ç½‘æ ¼æœ‰ç›¸äº¤ï¼ˆæœ‰é‡å éƒ¨åˆ†ï¼‰ï¼Œä¸€å®šè¦æ³¨æ„ä¸æ˜¯ä¸¤ä¸ªå…ƒç´ çš„RectåŒºåŸŸç›¸äº¤ã€‚</p>
</blockquote>
</li>
<li><p>å„ä¸ªUIçš„Depthè®¡ç®—å®Œæ¯•åï¼Œä¾æ¬¡æŒ‰ç…§<strong>Depthã€material IDã€texture IDã€RendererOrder</strong>ï¼ˆå³UIå±‚çº§é˜Ÿåˆ—é¡ºåºï¼Œå³Hierarchyé¢æ¿ä¸Šçš„é¡ºåºï¼‰æ’åºï¼ˆæ¡ä»¶çš„ä¼˜å…ˆçº§ä¾æ¬¡é€’å‡ï¼Œä¸”å‡ä¸ºä»å°åˆ°å¤§æ’åºï¼‰ã€‚ç„¶åå‰”é™¤Depth &#x3D; -1çš„UIå…ƒç´ ï¼Œå¾—åˆ°Batchå‰çš„UI å…ƒç´ é˜Ÿåˆ—ï¼Œè¿™ä¸ªé˜Ÿåˆ—è¢«ç§°ä¹‹ä¸ºVisiableListã€‚</p>
</li>
<li><p>å¾—åˆ°VisiableListä¹‹åï¼Œåˆ¤æ–­VisiableListä¸­ç›¸é‚»çš„å…ƒç´ <strong>æ˜¯å¦èƒ½å¤Ÿåˆæ‰¹</strong>ï¼ˆ<u>ç›¸åŒçš„æè´¨å’Œè´´å›¾</u>ï¼‰ã€‚éœ€è¦æ³¨æ„è¿™é‡Œä¸å†è€ƒè™‘Depthæ˜¯å¦ç›¸åŒï¼Œåªè¦ä¸¤ä¸ªå…ƒç´ ç›¸é‚»ç„¶åæè´¨å’Œè´´å›¾ç›¸åŒï¼Œå³ä½¿ä¸¤ä¸ªå…ƒç´ çš„Depthä¸ç›¸åŒï¼Œè¿™ä¸¤ä¸ªå…ƒç´ ä¹Ÿèƒ½åˆæ‰¹ã€‚ç„¶åä¸€ä¸ªæ‰¹æ¬¡ä¸€ä¸ªæ‰¹æ¬¡çš„åˆå¹¶ç½‘æ ¼ï¼Œæäº¤GPUè¿›è¡Œæ¸²æŸ“ã€‚</p>
</li>
</ol>
</li>
</ul>
<h3 id="ä¼˜åŒ–æŠ€å·§"><a href="#ä¼˜åŒ–æŠ€å·§" class="headerlink" title="ä¼˜åŒ–æŠ€å·§"></a>ä¼˜åŒ–æŠ€å·§</h3><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/466045943">UnityUIä¹‹UGUIä¼˜åŒ– - çŸ¥ä¹ (zhihu.com)</a></p>
<ul>
<li><p>åŠ¨é™åˆ†ç¦»ï¼ˆåŠ¨æ€éƒ¨åˆ†å’Œé™æ€éƒ¨åˆ†åˆ†åˆ«ä½¿ç”¨ä¸åŒçš„Canvasï¼‰ï¼›</p>
</li>
<li><p>é¿å…UIå…ƒç´ æ•°ç›®è¿‡å¤šå’Œå±‚æ¬¡ç»“æ„è¿‡äºå¤æ‚å½±å“Batchæ›´æ–°é€Ÿåº¦ï¼›</p>
</li>
<li><p>ä½¿ç”¨<strong>å›¾é›†</strong>ï¼ˆé¿å…texture IDä¸åŒå¯¼è‡´æ— æ³•åˆæ‰¹ï¼‰ï¼›</p>
</li>
<li><p>Textå¦‚æœå¯ä»¥ç”¨å›¾ç‰‡ä»£æ›¿å°±ç”¨å›¾ç‰‡ä»£æ›¿ï¼ˆUlä¸Šçš„å­—ä½“Textureä½¿ç”¨çš„æ˜¯å­—ä½“çš„å›¾é›†ï¼Œå¾€å¾€å’Œæˆ‘ä»¬è‡ªå·±çš„UIå›¾é›†ä¸ä¸€æ ·ï¼Œå› æ­¤æ— æ³•åˆæ‰¹ï¼‰ï¼›</p>
</li>
<li><p>é¿å…é¢‘ç¹åˆ é™¤&#x2F;å¢åŠ UIå¯¹è±¡ï¼ŒUIå±‚æ¬¡ç»“æ„å˜åŒ–ä¼šå¼•èµ·Canvasçš„æ›´æ–°(rebuild)ï¼›</p>
</li>
<li><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¸¸å¸¸ä½¿ç”¨gameObjectçš„activeæˆ–è€…è¯¥UIç»„ä»¶çš„enableæ¥è¿›è¡Œ<strong>æ˜¾éš</strong>ã€‚</p>
<p>ä½†å‚ç…§UGUIçš„æºç ï¼Œå®ƒä¼šåœ¨<strong>Enableçš„æ—¶å€™è®¾ç½®æˆè„æ ‡è®°</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnEnable</span>(<span class="params"></span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">base</span>.OnEnable();</span><br><span class="line">    CacheCanvas();</span><br><span class="line">    GraphicRegistry.RegisterGraphicForCanvas(canvas, <span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> UNITY_EDITOR</span></span><br><span class="line">        GraphicRebuildTracker.TrackGraphic(<span class="keyword">this</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">        <span class="keyword">if</span> (s_WhiteTexture == <span class="literal">null</span>)</span><br><span class="line">            s_WhiteTexture = Texture2D.whiteTexture;</span><br><span class="line"></span><br><span class="line">    SetAllDirty();<span class="comment">//è®¾ç½®æ‰€æœ‰è„æ ‡è®°</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶å¯ä»¥é€šè¿‡ä¸¤ä¸ªæ–¹é¢æ¥è¿›è¡Œæ˜¾éšï¼š</p>
<ul>
<li>å¯¹äºå•ä¸ªUIå¯ä»¥è®¾ç½®GetComponent<CanvasRenderer>().cullæ¥æ§åˆ¶</CanvasRenderer></li>
<li>è€Œå¤šä¸ªUIå¯ä»¥é€šè¿‡çˆ¶ç‰©ä½“æŒ‚ä¸ŠCanvasGroupï¼Œä¿®æ”¹Alphaå€¼æ¥æ§åˆ¶(??)</li>
</ul>
</li>
<li><p>å°½é‡ä¸è¦ä½¿ç”¨Maskï¼ˆå…¶å†…éƒ¨ä½¿ç”¨äº†æ¨¡æ¿ç¼“å†²ï¼Œè‡³å°‘ä¼šé€ æˆå¢åŠ 2ä¸ªDraw Callï¼‰</p>
<p><img src="/2023/09/01/%E7%9F%A5%E8%AF%86%E6%95%B4%E7%90%86-Unity-UI/hexo_github_blog\source_posts\çŸ¥è¯†æ•´ç†-Unity-UI.assets\image-20230904150757537.png" alt="image-20230904150757537"></p>
<p><img src="/2023/09/01/%E7%9F%A5%E8%AF%86%E6%95%B4%E7%90%86-Unity-UI/hexo_github_blog\source_posts\çŸ¥è¯†æ•´ç†-Unity-UI.assets\image-20230904150945509.png" alt="image-20230904150945509"></p>
<blockquote>
<p>ç›¸é‚»çš„ä¸¤ä¸ªImageåˆå¹¶ï¼Œè€Œå¤šäº†ä¸¤ä¸ªMaskï¼Œå¹¶ä¸”Imageåˆå¹¶è¢«æ‰“æ–­</p>
</blockquote>
</li>
</ul>
<h2 id="é‡ç»˜è¿‡ç¨‹ï¼ˆGraphicsï¼‰"><a href="#é‡ç»˜è¿‡ç¨‹ï¼ˆGraphicsï¼‰" class="headerlink" title="é‡ç»˜è¿‡ç¨‹ï¼ˆGraphicsï¼‰"></a>é‡ç»˜è¿‡ç¨‹ï¼ˆGraphicsï¼‰</h2><p>é‡ç»˜è¿‡ç¨‹æ˜¯æŒ‡Unity UI çš„ å›¾å½¢ç»„ä»¶çš„æ’ç‰ˆå’Œç½‘æ ¼è¢«é‡æ–°è®¡ç®—ã€‚è¿™åœ¨ CanvasUpdateRegistryç±»ä¸­æ‰§è¡Œã€‚å½“Canvasç»„ä»¶è§¦å‘WillRenderCanvasesäº‹ä»¶æ—¶éƒ½ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚è¿™ä¸ªäº‹ä»¶æ¯ä¸€å¸§éƒ½ä¼šæ‰§è¡Œä¸€æ¬¡ã€‚åœ¨CanvasUpdateRegistryå†…éƒ¨ï¼Œéœ€è¦å…³æ³¨çš„æ–¹æ³•æ˜¯PerformUpdateã€‚</p>
<h3 id="å¤§è‡´ç†è§£"><a href="#å¤§è‡´ç†è§£" class="headerlink" title="å¤§è‡´ç†è§£"></a>å¤§è‡´ç†è§£</h3><p>ä¹Ÿä»ä¸€ä¸ªç®€å•çš„demoå¼€å§‹è°ƒè¯•ç†è§£ã€‚demoå†…å®¹æ˜¯ï¼Œç‚¹å‡»button<strong>è§¦å‘æŸä¸ªImageæ¢é¢œè‰²</strong>ã€‚</p>
<ul>
<li>æ›´æ”¹é¢œè‰²ï¼Œè§¦å‘SetVerticesDirty();</li>
<li>SetVerticesDirty()â€”â€”Registerâ€¦Rebuildï¼šåŠ å…¥æŸä¸ªé˜Ÿåˆ—ï¼›</li>
<li>PerformUpdate(): åº”ç”¨äº†é˜Ÿåˆ—ï¼Œå–elementï¼Œè°ƒç”¨å®ƒçš„Rebuild</li>
<li>å¦‚æœæ ‡è®°äº†dirtyï¼Œå°±è¿›è¡ŒUpdateGeometryâ€¦OnPopulateMeshâ€¦Generateâ€¦æœ€åæ›´æ”¹é¢œè‰²ã€‚</li>
</ul>
<p><img src="/2023/09/01/%E7%9F%A5%E8%AF%86%E6%95%B4%E7%90%86-Unity-UI/hexo_github_blog\source_posts\çŸ¥è¯†æ•´ç†-Unity-UI.assets\image-20230901120719354.png" alt="image-20230901120719354"></p>
<blockquote>
<p>â‘¢æŠŠæ›´æ”¹æ”¾è¿›é˜Ÿåˆ—é‡Œé¢å»ï¼Œå¹¶ç”±PerformUpdateè°ƒç”¨â‘£ï¼Œç”±äºRebuildæ¥å£è¢«Graphicå®ç°ï¼ŒImageåˆç»§æ‰¿Graphicï¼Œç»è¿‡ä¸€ç³»åˆ—çš„è°ƒç”¨å›åˆ°â‘¥</p>
<p>æ¦‚æ‹¬æ¥è¯´ï¼Œè¢«æ›´æ”¹çš„å…ƒç´ å­˜äº†ä¸‹æ¥ï¼Œå¹¶åœ¨performUpdateåˆæ”¾å‡ºæ¥è°ƒç”¨è‡ªå·±çš„Rebuild</p>
</blockquote>
<p>é‚£PerformUpdateåœ¨å“ªé‡Œè°ƒç”¨äº†ï¼Ÿè¿™ä¸ªæ–¹æ³•è¢«æ³¨å†Œè¿›Canvas.willRenderCanvasesï¼ˆåœ¨æ¸²æŸ“ä¹‹å‰è°ƒç”¨ï¼‰é‡Œé¢å»äº†ã€‚</p>
<p><img src="/2023/09/01/%E7%9F%A5%E8%AF%86%E6%95%B4%E7%90%86-Unity-UI/hexo_github_blog\source_posts\çŸ¥è¯†æ•´ç†-Unity-UI.assets\image-20230901121506723.png" alt="image-20230901121506723"></p>
<h3 id="ç¼“å­˜å’Œé‡å»ºï¼šCanvasUpdateRegistry"><a href="#ç¼“å­˜å’Œé‡å»ºï¼šCanvasUpdateRegistry" class="headerlink" title="ç¼“å­˜å’Œé‡å»ºï¼šCanvasUpdateRegistry"></a><strong>ç¼“å­˜å’Œé‡å»ºï¼šCanvasUpdateRegistry</strong></h3><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/chenggg/p/11184784.html">å…³äºUGUIåº•å±‚çš„å°çŸ¥è¯†â€”ä¸Š (è½¬é›¨æ¾momo) - æ·±ç§‹å¤§è¡—é“ - åšå®¢å›­ (cnblogs.com)</a></p>
<ul>
<li><p>ã€ç¼“å­˜è¦æ›´æ”¹çš„å…ƒç´ ã€‘é€šå¸¸UGUIç•Œé¢æ“ä½œå¡å¤§æ¦‚ç‡éƒ½æ˜¯Canvas.SendWillRenderCanvases()æ–¹æ³•è€—æ—¶ï¼Œéœ€è¦æ£€æŸ¥<u>ç•Œé¢æ˜¯å¦å­˜åœ¨å¤šä½™æˆ–è€…æ— ç”¨çš„é‡å»ºæƒ…å†µ</u>ã€‚ç”±äºç•Œé¢å¾ˆå¤šæˆ‘ä»¬æ— æ³•å®šä½åˆ°åˆ°åº•æ˜¯å“ªä¸ªç•Œé¢ä¸‹çš„å“ªä¸ªå…ƒç´ å¼•èµ·äº†ç½‘æ ¼é‡å»ºã€‚é€šè¿‡è§‚å¯ŸCanvasUpdateRegistry.csæºä»£ç ï¼Œæˆ‘ä»¬å‘ç°éœ€è¦ç½‘æ ¼é‡å»ºçš„å…ƒç´ éƒ½è¢«ç¼“å­˜åœ¨è¿™ä¸¤ä¸ªå¯¹è±¡ä¸­ã€‚ </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ ‡è®°æ›´æ”¹ Graphic.cs</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> abstract <span class="class"><span class="keyword">class</span> <span class="title">Graphic</span>:</span> UIBehaviour,ICanvasElement</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//...ç•¥</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnBeforeTransformParentChanged</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        GraphicRegistry.<span class="built_in">UnregisterGraphicForCanvas</span>(canvas, <span class="keyword">this</span>);</span><br><span class="line">        <span class="comment">//å¸ƒå±€å‘ç”Ÿå˜åŒ–</span></span><br><span class="line">        LayoutRebuilder.<span class="built_in">MarkLayoutForRebuild</span>(rectTransform);</span><br><span class="line">        <span class="comment">//LayoutRebuilder.MarkLayoutForRebuildæ–¹æ³•å†…éƒ¨å®ç°</span></span><br><span class="line">        <span class="comment">//private static void MarkLayoutRootForRebuild(RectTransform controller)</span></span><br><span class="line">        <span class="comment">//&#123;</span></span><br><span class="line">        <span class="comment">//    if (controller == null)</span></span><br><span class="line">        <span class="comment">//        return;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//    var rebuilder = s_Rebuilders.Get();</span></span><br><span class="line">        <span class="comment">//    rebuilder.Initialize(controller);</span></span><br><span class="line">        <span class="comment">//    å±€éƒ¨å‘ç”Ÿå˜åŒ–ï¼Œä¼šé€šè¿‡TryRegisterCanvasElementForLayoutRebuild()å°†è‡ªå·±åŠ å…¥å¾…å¸ƒå±€é‡å»ºé˜Ÿåˆ—</span></span><br><span class="line">        <span class="comment">//    if (!CanvasUpdateRegistry.TryRegisterCanvasElementForLayoutRebuild(rebuilder))</span></span><br><span class="line">        <span class="comment">//        s_Rebuilders.Release(rebuilder);</span></span><br><span class="line">        <span class="comment">//&#125;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">SetMaterialDirty</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">IsActive</span>())</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        m_MaterialDirty = <span class="literal">true</span>;</span><br><span class="line">        <span class="comment">//æ¸²æŸ“å‘ç”Ÿå˜åŒ–ï¼Œä¼šé€šè¿‡RegisterCanvasElementForGraphicRebuild()å°†è‡ªå·±åŠ å…¥å¾…æ¸²æŸ“é˜Ÿåˆ—</span></span><br><span class="line">        CanvasUpdateRegistry.<span class="built_in">RegisterCanvasElementForGraphicRebuild</span>(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (m_OnDirtyMaterialCallback != null)</span><br><span class="line">            <span class="built_in">m_OnDirtyMaterialCallback</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">// å°†æ ‡è®°æ”¾å…¥ç¼“å­˜é˜Ÿåˆ—</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CanvasUpdateRegistry</span></span></span><br><span class="line"><span class="class">  &#123;</span></span><br><span class="line">      <span class="comment">//...ç•¥</span></span><br><span class="line">      <span class="comment">//ä¿å­˜å¾…é‡å»ºå¸ƒå±€å…ƒç´ ï¼ˆå¦‚ï¼šRectTransformå˜åŒ–ï¼‰</span></span><br><span class="line">      <span class="keyword">private</span> readonly IndexedSet&lt;ICanvasElement&gt; m_LayoutRebuildQueue = <span class="keyword">new</span> IndexedSet&lt;ICanvasElement&gt;();</span><br><span class="line">      <span class="comment">//ä¿å­˜å¾…é‡å»ºæ¸²æŸ“å…ƒç´ ï¼ˆå¦‚ï¼šImageå˜åŒ–ï¼‰</span></span><br><span class="line">      <span class="keyword">private</span> readonly IndexedSet&lt;ICanvasElement&gt; m_GraphicRebuildQueue = <span class="keyword">new</span> IndexedSet&lt;ICanvasElement&gt;();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">* ã€æ›´æ”¹ç¼“å­˜é˜Ÿåˆ—é‡Œçš„å…ƒç´ ï¼ˆåœ¨PerformUpdateé‡Œé¢ğŸ‘‡ï¼‰ã€‘ç”±æ­¤å¯è§ï¼Œ&lt;u&gt;UIå‘ç”Ÿå˜åŒ–ä¸€èˆ¬åˆ†ä¸¤ç§æƒ…å†µ&lt;/u&gt;ï¼Œä¸€ç§æ˜¯ä¿®æ”¹äº†å®½é«˜è¿™æ ·ä¼šå½±å“åˆ°é¡¶ç‚¹ä½ç½®éœ€è¦é‡å»ºMeshï¼Œè¿˜æœ‰ä¸€ç§ä»…ä»…åªä¿®æ”¹äº†æ˜¾ç¤ºå…ƒç´ ï¼Œè¿™æ ·å¹¶ä¸ä¼šå½±å“é¡¶ç‚¹ä½ç½®ï¼Œæ­¤æ—¶unityä¼šåœ¨ä»£ç ä¸­åŒºåˆ«å¯¹å¾…ã€‚</span><br><span class="line"></span><br><span class="line">  ```cpp</span><br><span class="line">  <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CanvasUpdateRegistry</span></span></span><br><span class="line"><span class="class">  &#123;</span></span><br><span class="line">      <span class="comment">//...ç•¥</span></span><br><span class="line">      <span class="function"><span class="keyword">protected</span> <span class="title">CanvasUpdateRegistry</span><span class="params">()</span></span></span><br><span class="line"><span class="function">      </span>&#123;</span><br><span class="line">          <span class="comment">//æ„é€ å‡½æ•°å¤„å§”æ‰˜å‡½æ•°åˆ°PerformUpdate()æ–¹æ³•ä¸­</span></span><br><span class="line">          <span class="comment">//æ¯æ¬¡Canvas.willRenderCanvaseså°±ä¼šæ‰§è¡ŒPerformUpdate()æ–¹æ³•</span></span><br><span class="line">          Canvas.willRenderCanvases += PerformUpdate;</span><br><span class="line">      &#125;</span><br><span class="line">  </span><br><span class="line">      <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">PerformUpdate</span><span class="params">()</span></span></span><br><span class="line"><span class="function">      </span>&#123;</span><br><span class="line">          <span class="comment">//å¼€å§‹BeginSample()</span></span><br><span class="line">          <span class="comment">//åœ¨Profilerä¸­çœ‹åˆ°çš„æ ‡å¿—æ€§å‡½æ•°Canvas.willRenderCanvasesè€—æ—¶å°±åœ¨è¿™é‡Œäº†</span></span><br><span class="line">          <span class="comment">//EndSample()</span></span><br><span class="line">          UISystemProfilerApi.<span class="built_in">BeginSample</span>(UISystemProfilerApi.SampleType.Layout);</span><br><span class="line">          <span class="built_in">CleanInvalidItems</span>();</span><br><span class="line">  </span><br><span class="line">          m_PerformingLayoutUpdate = <span class="literal">true</span>;</span><br><span class="line">          <span class="comment">//éœ€è¦é‡å»ºçš„å¸ƒå±€å…ƒç´ (RectTransformå‘ç”Ÿå˜åŒ–)ï¼Œé¦–å…ˆéœ€è¦æ ¹æ®å­å¯¹è±¡çš„æ•°é‡å¯¹å®ƒè¿›è¡Œæ’åºã€‚</span></span><br><span class="line">          m_LayoutRebuildQueue.<span class="built_in">Sort</span>(s_SortLayoutFunction);</span><br><span class="line">          <span class="comment">//éå†å¾…é‡å»ºå¸ƒå±€å…ƒç´ é˜Ÿåˆ—ï¼Œå¼€å§‹é‡å»º</span></span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= (<span class="keyword">int</span>)CanvasUpdate.PostLayout; i++)</span><br><span class="line">          &#123;</span><br><span class="line">              <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; m_LayoutRebuildQueue.Count; j++)</span><br><span class="line">              &#123;</span><br><span class="line">                  var rebuild = instance.m_LayoutRebuildQueue[j];</span><br><span class="line">                  <span class="keyword">try</span></span><br><span class="line">                  &#123;</span><br><span class="line">                      <span class="keyword">if</span> (<span class="built_in">ObjectValidForUpdate</span>(rebuild))</span><br><span class="line">                          rebuild.<span class="built_in">Rebuild</span>((CanvasUpdate)i);<span class="comment">//é‡å»ºå¸ƒå±€å…ƒç´ </span></span><br><span class="line">                  &#125;</span><br><span class="line">                  <span class="built_in"><span class="keyword">catch</span></span> (Exception e)</span><br><span class="line">                  &#123;</span><br><span class="line">                      Debug.<span class="built_in">LogException</span>(e, rebuild.transform);</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">  </span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m_LayoutRebuildQueue.Count; ++i)</span><br><span class="line">              m_LayoutRebuildQueue[i].<span class="built_in">LayoutComplete</span>();</span><br><span class="line">  </span><br><span class="line">          <span class="comment">//å¸ƒå±€æ„å»ºå®Œæˆåæ¸…ç©ºé˜Ÿåˆ—</span></span><br><span class="line">          instance.m_LayoutRebuildQueue.<span class="built_in">Clear</span>();</span><br><span class="line">          m_PerformingLayoutUpdate = <span class="literal">false</span>;</span><br><span class="line">  </span><br><span class="line">          <span class="comment">// å¸ƒå±€æ„å»ºç»“æŸï¼Œå¼€å§‹è¿›è¡ŒMask2Dè£åˆ‡ï¼ˆè¯¦ç»†å†…å®¹ä¸‹é¢ä¼šä»‹ç»ï¼‰</span></span><br><span class="line">          ClipperRegistry.instance.<span class="built_in">Cull</span>();</span><br><span class="line">  </span><br><span class="line">          m_PerformingGraphicUpdate = <span class="literal">true</span>;</span><br><span class="line">  </span><br><span class="line">          <span class="comment">//éœ€è¦é‡å»ºçš„Graphicså…ƒç´ (Image Text RawImage å‘ç”Ÿå˜åŒ–)</span></span><br><span class="line">          <span class="keyword">for</span> (var i = (<span class="keyword">int</span>)CanvasUpdate.PreRender; i &lt; (<span class="keyword">int</span>)CanvasUpdate.MaxUpdateValue; i++)</span><br><span class="line">          &#123;</span><br><span class="line">              <span class="keyword">for</span> (var k = <span class="number">0</span>; k &lt; instance.m_GraphicRebuildQueue.Count; k++)</span><br><span class="line">              &#123;</span><br><span class="line">                  <span class="keyword">try</span></span><br><span class="line">                  &#123;</span><br><span class="line">                      var element = instance.m_GraphicRebuildQueue[k];</span><br><span class="line">                      <span class="keyword">if</span> (<span class="built_in">ObjectValidForUpdate</span>(element))</span><br><span class="line">                          element.<span class="built_in">Rebuild</span>((CanvasUpdate)i);<span class="comment">//é‡å»ºUIå…ƒç´ </span></span><br><span class="line">                  &#125;</span><br><span class="line">                  <span class="built_in"><span class="keyword">catch</span></span> (Exception e)</span><br><span class="line">                  &#123;</span><br><span class="line">                      Debug.<span class="built_in">LogException</span>(e, instance.m_GraphicRebuildQueue[k].transform);</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">  </span><br><span class="line">          <span class="comment">//è¿™é‡Œéœ€è¦æ€è€ƒçš„æ˜¯ï¼Œæœ‰å¯èƒ½ä¸€ä¸ªImageå¯¹è±¡ï¼ŒRectTransformå’ŒGraphicsåŒæ—¶å‘ç”Ÿäº†ä¿®æ”¹ï¼Œå®ƒä»¬çš„æ›´æ–°å«ä¹‰ä¸åŒéœ€è¦åŒºåˆ†å¯¹å¾…</span></span><br><span class="line">          <span class="comment">//1.ä¿®æ”¹äº†Imageçš„å®½é«˜ï¼Œè¿™æ ·Meshçš„é¡¶ç‚¹ä¼šå‘ç”Ÿå˜åŒ–ï¼Œæ­¤æ—¶è¯¥å¯¹è±¡ä¼šåŠ å…¥m_LayoutRebuildQueueé˜Ÿåˆ—</span></span><br><span class="line">          <span class="comment">//2.ä¿®æ”¹äº†Imageçš„Spriteï¼Œå®ƒå¹¶ä¸ä¼šå½±å“é¡¶ç‚¹ä½ç½®ä¿¡æ¯ï¼Œæ­¤æ—¶è¯¥å¯¹è±¡ä¼šåŠ å…¥m_GraphicRebuildQueueé˜Ÿåˆ—</span></span><br><span class="line">          <span class="comment">//æ‰€ä»¥ä¸Šé¢ä»£ç åœ¨éå†çš„æ—¶å€™ä¼šåˆ†å±‚</span></span><br><span class="line">          <span class="comment">//for (int i = 0; i &lt;= (int)CanvasUpdate.PostLayout; i++)</span></span><br><span class="line">          <span class="comment">//for (var i = (int)CanvasUpdate.PreRender; i &lt; (int)CanvasUpdate.MaxUpdateValue; i++)</span></span><br><span class="line">          <span class="comment">//Rebuildçš„æ—¶å€™ä¼šæŠŠå±‚ä¼ è¿›å»ï¼Œä¿è¯ImageçŸ¥é“ç°åœ¨æ˜¯è¦æ›´æ–°å¸ƒå±€ï¼Œè¿˜æ˜¯åªæ›´æ–°æ¸²æŸ“ã€‚</span></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m_GraphicRebuildQueue.Count; ++i)</span><br><span class="line">              m_GraphicRebuildQueue[i].<span class="built_in">GraphicUpdateComplete</span>();</span><br><span class="line">  </span><br><span class="line">          instance.m_GraphicRebuildQueue.<span class="built_in">Clear</span>();</span><br><span class="line">          m_PerformingGraphicUpdate = <span class="literal">false</span>;</span><br><span class="line">          UISystemProfilerApi.<span class="built_in">EndSample</span>(UISystemProfilerApi.SampleType.Layout);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<ul>
<li>æ ‡è®°ä¸ºdirtyçš„æ’ç‰ˆç»„ä»¶é€šè¿‡ICanvasElement.Rebuildæ–¹æ³•<strong>é‡å»ºå¸ƒå±€</strong>ï¼Œæ’ç‰ˆé‡å»ºåˆ†æˆä¸‰ä¸ªè¿‡ç¨‹ï¼ˆPreLayout, Layout å’Œ PostLayoutï¼‰ã€‚</li>
<li>ä»»ä½•æ³¨å†Œè¿‡çš„è£å‰ªç»„ä»¶ï¼ˆå¦‚maskï¼‰ï¼Œéœ€è¦å»<strong>è£å‰ªæ‰€æœ‰å¯å‰”é™¤çš„ç»„ä»¶</strong>ã€‚è¿™æ˜¯é€šè¿‡ClippingRegistry.Cullå®ç°çš„ã€‚</li>
<li>è¢«æ ‡è®°ä¸ºdirtyçš„å›¾å½¢ç»„ä»¶ï¼Œé€šè¿‡ICanvasElement.Rebuildæ–¹æ³•é‡å»ºå®ƒä»¬çš„å›¾å½¢å…ƒç´ ï¼Œ<strong>é‡å»ºå›¾å½¢</strong>åŒ…å«ä¸¤ä¸ªè¿‡ç¨‹ï¼ˆPreRender å’Œ LatePreRenderï¼‰ã€‚</li>
</ul>
<blockquote>
<p>Layoutå’ŒGraphicçš„é‡å»ºè¿‡ç¨‹ä¼šè¢«æ‹†åˆ†æˆå¤šä¸ªéƒ¨åˆ†ã€‚</p>
<p>Layouté‡å»ºåˆ†3æ­¥å®Œæˆ(PreLayout,Layoutå’ŒPostLayout),</p>
<p>Graphicé‡å»ºåˆ†2æ­¥å®Œæˆ(PreRenderå’ŒLatePreRender)</p>
</blockquote>
<h3 id="é‡ç»˜è§¦å‘çš„æ¡ä»¶"><a href="#é‡ç»˜è§¦å‘çš„æ¡ä»¶" class="headerlink" title="é‡ç»˜è§¦å‘çš„æ¡ä»¶"></a>é‡ç»˜è§¦å‘çš„æ¡ä»¶</h3><p>enableï¼Œdisableï¼Œvalidateéƒ½ä¼šè§¦å‘</p>
<ul>
<li><strong>SetVerticesDirty</strong></li>
</ul>
<p>MeshEffectæœ‰å˜åŒ–</p>
<p>shadowå±æ€§æ”¹ç‰ˆ</p>
<p>transformå¤§å°æ”¹å˜</p>
<p>imageç±»å‹æ”¹å˜ï¼Œå±‚çº§æ”¹å˜ï¼Œå¡«å……æ–¹å¼æ”¹å˜</p>
<p>RawImageï¼štextureæ”¹å˜ï¼ŒuvRectæ”¹å˜ï¼Œè§¦å‘åŠ¨ç”»æ•ˆæœ</p>
<p>textå†…å®¹æ”¹å˜ï¼Œå¼€å…³richtexï¼Œç­‰ç­‰å¾ˆå¤šï¼Œtextæ˜¯æœ€é¢‘ç¹dirtyçš„</p>
<ul>
<li><strong>SetMaterialDirty</strong></li>
</ul>
<p>materialæ›¿æ¢</p>
<p>Imageè§¦å‘åŠ¨ç”»</p>
<p>æ˜¾ç¤ºmaskï¼Œè®¾ç½®æ˜¯å¦å¼€å¯mask</p>
<p>transformå±‚çº§å˜åŒ–</p>
<p>canvaså±‚çº§å˜åŒ–</p>
<p>é‡æ–°è®¡ç®—mask</p>
<p>RawImageæ›¿æ¢textureï¼Œä½¿è§¦å‘åŠ¨ç”»</p>
<ul>
<li><strong>åŒæ—¶dirtyï¼ŒåŒ…æ‹¬layout</strong></li>
</ul>
<p>transformå±‚çº§æ”¹å˜</p>
<p>Spriteæ›¿æ¢ï¼Œæ”¹å˜å›¾ç‰‡å¤§å°ï¼Œæ›¿æ¢å›¾é›†</p>
<p>å­—ä½“æ”¹å˜ï¼Œå­—ä½“å›¾é›†å˜åŒ–</p>
<p>ã€å¾…ç»†ç©¶â€¦â€¦ã€‘</p>
<h3 id="å¸ƒå±€é‡å»ºï¼ˆè¯¦ç»†ï¼‰"><a href="#å¸ƒå±€é‡å»ºï¼ˆè¯¦ç»†ï¼‰" class="headerlink" title="å¸ƒå±€é‡å»ºï¼ˆè¯¦ç»†ï¼‰"></a>å¸ƒå±€é‡å»ºï¼ˆè¯¦ç»†ï¼‰</h3><blockquote>
<p>å¿…é¡»<strong>æ ¹æ®Layoutå±‚çº§é¡ºåº</strong>è®¡ç®—é‚£äº›åŒ…å«åœ¨Layoutä¸­çš„ç»„ä»¶çš„ä½ç½®å’Œå°ºå¯¸ã€‚åœ¨Game Objectå±‚çº§ä¸­ï¼Œç¦»æ ¹èŠ‚ç‚¹è¿‘çš„Layoutæœ‰å¯èƒ½ä¼šæ”¹å˜åµŒå¥—åœ¨åœ¨å®ƒé‡Œé¢çš„Layoutçš„ä½ç½®å’Œå°ºå¯¸ï¼Œæ‰€ä»¥å®ƒéœ€è¦è¢«å…ˆè®¡ç®—ã€‚</p>
</blockquote>
<blockquote>
<p>ä¸ºæ­¤ï¼ŒUIç³»ç»Ÿä¾æ®<strong>Layoutåœ¨å±‚çº§ä¸­çš„æ·±åº¦</strong>å¯¹è„Layoutåˆ—è¡¨ä¸­çš„Layoutè¿›è¡Œæ’åºï¼Œé«˜å±‚çš„ï¼ˆä¾‹å¦‚ï¼Œçˆ¶Transformæ›´å°‘ï¼‰çš„é¡¹ä¼šè¢«ç§»åŠ¨åˆ°åˆ—è¡¨çš„å‰é¢ã€‚</p>
</blockquote>
<blockquote>
<p><strong>æ’åºåçš„Layoutç»„ä»¶åˆ—è¡¨</strong>æ¥ä¸‹æ¥è¦é‡å»ºå¸ƒå±€ã€‚è¿™æ—¶è¢«Layoutç»„ä»¶æ§åˆ¶çš„UIå…ƒç´ çš„ä½ç½®å’Œå°ºå¯¸ä¼šå‘ç”Ÿæ”¹å˜ã€‚æœ‰å…³<strong>Layoutå¦‚ä½•å½±å“æ¯ä¸ªå…ƒç´ çš„ä½ç½®</strong>çš„è¯¦ç»†å™è¿°ï¼Œè¯·æŸ¥çœ‹Unityæ‰‹å†Œä¸­çš„<a target="_blank" rel="noopener" href="https://docs.unity3d.com/Manual/UIAutoLayout.html">UI Auto Layout</a></p>
</blockquote>
<p><strong>è‡ªåŠ¨å¸ƒå±€ç³»ç»ŸæŒ‰ä»¥ä¸‹é¡ºåºè¯„ä¼°å’Œæ‰§è¡Œå¸ƒå±€ï¼š</strong></p>
<ol>
<li>é€šè¿‡è°ƒç”¨ILayoutElementç»„ä»¶ä¸Šçš„CalculateLayoutInputHorizontalæ¥è®¡ç®—å¸ƒå±€å…ƒç´ çš„æœ€å°å€¼ï¼Œé¦–é€‰å€¼å’Œçµæ´»å®½åº¦ã€‚è¿™æ˜¯ä»¥<strong>è‡ªä¸‹è€Œä¸Šçš„é¡ºåº</strong>è¿›è¡Œçš„ï¼Œ<strong>å­©å­åœ¨çˆ¶æ¯é¢å‰è®¡ç®—</strong>ï¼Œè¿™æ ·çˆ¶æ¯å¯ä»¥åœ¨ä»–ä»¬è‡ªå·±çš„è®¡ç®—ä¸­è€ƒè™‘åˆ°å­©å­çš„ä¿¡æ¯ã€‚</li>
<li>é€šè¿‡è°ƒç”¨ILayoutControllerç»„ä»¶ä¸Šçš„SetLayoutHorizontalï¼Œæ ¹æ®çˆ¶å¯¹è±¡çš„å¯ç”¨å®½åº¦ï¼Œæ¥è®¡ç®—å’Œè®¾ç½®å­å¯¹è±¡å¸ƒå±€å…ƒç´ çš„å®½åº¦ã€‚è¿™æ˜¯æŒ‰ç…§<strong>è‡ªä¸Šè€Œä¸‹çš„é¡ºåº</strong>æ‰§è¡Œçš„ï¼Œå› ä¸ºå­©å­çš„çˆ¶æ¯åˆ†é…çš„å­å®½åº¦éœ€è¦æ ¹æ®çˆ¶æ¯çš„å¯ç”¨å®½åº¦è¿›è¡Œåˆ†é…ã€‚åœ¨è¿™ä¸€æ­¥ä¹‹åï¼Œå¸ƒå±€å…ƒç´ çš„Rectå˜æ¢å…·æœ‰æ–°çš„å®½åº¦ã€‚</li>
<li>é€šè¿‡è°ƒç”¨ILayoutElementç»„ä»¶çš„CalculateLayoutInputVerticalæ¥è®¡ç®—å¸ƒå±€å…ƒç´ çš„æœ€å°å€¼ï¼Œé¦–é€‰å€¼å’Œçµæ´»é«˜åº¦ã€‚è¿™æ˜¯ä»¥<strong>è‡ªä¸‹è€Œä¸Šçš„é¡ºåº</strong>è¿›è¡Œçš„ï¼Œå­©å­åœ¨çˆ¶æ¯é¢å‰è®¡ç®—ï¼Œè¿™æ ·çˆ¶æ¯å¯ä»¥åœ¨ä»–ä»¬è‡ªå·±çš„è®¡ç®—ä¸­è€ƒè™‘åˆ°å­©å­çš„ä¿¡æ¯ã€‚</li>
<li>é€šè¿‡è°ƒç”¨ILayoutControllerç»„ä»¶çš„SetLayoutVerticalï¼Œæ ¹æ®çˆ¶å¯¹è±¡çš„å¯ç”¨é«˜åº¦ï¼Œæ¥è®¡ç®—å’Œè®¾ç½®å­å¯¹è±¡å¸ƒå±€å…ƒç´ çš„é«˜åº¦ã€‚è¿™æ˜¯æŒ‰ç…§è‡ªä¸Šè€Œä¸‹çš„é¡ºåºæ‰§è¡Œçš„ï¼Œå› ä¸ºå­å¥³çš„é«˜åº¦éœ€è¦æ ¹æ®çˆ¶æ¯çš„å¯ç”¨é«˜åº¦è®¡ç®—ï¼Œå­å¥³æ˜¯åœ¨çˆ¶æ¯ä¹‹åè®¡ç®—çš„ã€‚åœ¨è¿™ä¸€æ­¥ä¹‹åï¼Œå¸ƒå±€å…ƒç´ çš„Rectå˜æ¢æœ‰äº†æ–°çš„é«˜åº¦ã€‚</li>
</ol>
<p><strong>ä½•æ—¶è§¦å‘å¸ƒå±€é‡å»ºï¼š</strong></p>
<ul>
<li>æ›´æ”¹LayoutElementå¸ƒå±€å…ƒç´ çš„å±æ€§æ—¶ï¼Œæ¯”å¦‚ä¿®æ”¹Min Widthï¼ŒPreferred Widthç­‰å±æ€§ã€‚</li>
<li><strong>åœ¨OnEnableå’ŒOnDisableä¸­</strong></li>
<li>OnRectTransformDimensionsChange**ï¼ˆRectTransformå¤§å°å‘ç”Ÿæ”¹å˜æ—¶ï¼‰**</li>
<li>OnValidate ï¼ˆåªèƒ½ç¼–è¾‘å™¨ä¸­ï¼Œéè¿è¡ŒçŠ¶æ€ï¼‰</li>
<li>OnDidApplyAnimationPropertiesï¼ˆåº”ç”¨åŠ¨ç”»å±æ€§æ—¶ï¼‰</li>
</ul>
<h3 id="å›¾å½¢é‡å»ºï¼ˆè¯¦ç»†ï¼‰"><a href="#å›¾å½¢é‡å»ºï¼ˆè¯¦ç»†ï¼‰" class="headerlink" title="å›¾å½¢é‡å»ºï¼ˆè¯¦ç»†ï¼‰"></a>å›¾å½¢é‡å»ºï¼ˆè¯¦ç»†ï¼‰</h3><p><strong>Rebuildæ–¹æ³•</strong></p>
<p>åœ¨Canvasæ¸²æŸ“å‰è¢«è°ƒç”¨ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•é‡Œä¼šè°ƒç”¨UpdateGeometryå’ŒUpdateMaterialæ›´æ–°é¡¶ç‚¹å’Œæè´¨ã€‚</p>
<p><img src="https://img2018.cnblogs.com/blog/1296185/201907/1296185-20190714165439386-1677932551.png" alt="img"></p>
<p><strong>UpdateGeometryæ–¹æ³•</strong></p>
<p>ç¡®å®šæ¯ä¸€ä¸ªUIå…ƒç´ Meshçš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬é¡¶ç‚¹æ•°æ®ã€ä¸‰è§’å½¢æ•°æ®ã€UVæ•°æ®ã€é¡¶ç‚¹è‰²æ•°æ®ã€‚å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼Œæ— è®ºImageè¿˜æ˜¯Textæ•°æ®éƒ½ä¼šåœ¨OnPopulateMeshå‡½æ•°ä¸­è¿›è¡Œæ”¶é›†ï¼Œå®ƒæ˜¯ä¸€ä¸ªè™šå‡½æ•°ä¼šåœ¨å„è‡ªçš„ç±»ä¸­å®ç°ã€‚</p>
<p><img src="https://img2018.cnblogs.com/blog/1296185/201907/1296185-20190714165509919-914957298.png" alt="img"></p>
<ul>
<li>è°ƒç”¨<strong>DoMeshGeneration</strong>æ–¹æ³•ï¼Œ</li>
<li>å¦‚æœrectTransformä¸ä¸ºç©ºï¼Œä¸”å®½é«˜éƒ½å¤§äº0ï¼Œè°ƒç”¨<strong>OnPopulateMesh</strong>ï¼Œå®é™…ä¸Šåªæ˜¯æŠŠé¡¶ç‚¹å’Œä¸‰è§’å½¢ä¿¡æ¯ä¿å­˜åˆ°äº†s_VertexHelperé‡Œã€‚</li>
<li>ç„¶åè·å–æ‰€æœ‰çš„<strong>IMeshModifier</strong>ç±»å‹çš„ç»„ä»¶ï¼Œï¼ˆIMeshModifieræ˜¯ä¸€ä¸ªæ¥å£ï¼Œéœ€è¦ä¾æ®é¡¶ç‚¹ä¿¡æ¯çš„ç»„ä»¶ç»§æ‰¿è‡ªå®ƒï¼Œä¾‹å¦‚Shadowå°±é—´æ¥ç»§æ‰¿è‡ªå®ƒï¼‰ï¼Œè°ƒç”¨IMeshModifierçš„ModifyMeshæ–¹æ³•ï¼Œä¿®æ”¹Meshä¿¡æ¯ã€‚</li>
<li>æœ€åå°†s_VertexHelperé‡Œä¿®æ”¹åçš„ä¿¡æ¯è®¾ç½®ç»™canvasRendererã€‚<strong>æ¦‚æ‹¬çš„è¯´å°±æ˜¯ï¼ŒæŠŠé¡¶ç‚¹å’Œä¸‰è§’å½¢ä¿¡æ¯è¿›è¡Œä¿®æ”¹ï¼Œå¹¶è®¾ç½®ç»™CanvasRendererã€‚</strong></li>
<li>é¡¶ç‚¹æ•°æ®å‡†å¤‡å®Œæ¯•åä¼šè°ƒç”¨canvasRenderer.SetMesh()æ–¹æ³•æ¥æäº¤ã€‚å¾ˆé—æ†¾CanvasRenderer.cså¹¶æ²¡æœ‰å¼€æºï¼Œæˆ‘ä»¬åªèƒ½ç»§ç»­åç¼–è¯‘çœ‹å®ƒçš„å®ç°äº†ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼ŒSetMesh()æ–¹æ³•æœ€ç»ˆåœ¨C++ä¸­å®ç°ï¼Œæ¯•ç«Ÿç”±äºUIçš„å…ƒç´ å¾ˆå¤šï¼ŒåŒæ—¶å‚ä¸åˆå¹¶é¡¶ç‚¹çš„ä¿¡æ¯ä¹Ÿä¼šå¾ˆå¤šï¼Œåœ¨C++ä¸­å®ç°æ•ˆç‡ä¼šæ›´å¥½ã€‚çœ‹åˆ°è¿™é‡Œï¼Œæˆ‘ç›¸ä¿¡å¤§å®¶åº”è¯¥èƒ½æ˜ç™½UGUIä¸ºä»€ä¹ˆæ•ˆç‡ä¼šè¢«NGUIè¦é«˜ä¸€äº›äº†ï¼Œå› ä¸ºNGUIçš„ç½‘æ ¼Meshåˆå¹¶éƒ½æ˜¯åœ¨C#ä¸­å®Œæˆçš„ï¼Œè€Œ<strong>UGUIç½‘æ ¼åˆå¹¶éƒ½æ˜¯åœ¨C++ä¸­åº•å±‚ä¸­å®Œæˆçš„</strong>ã€‚</li>
</ul>
<p><strong>UpdateMaterialæ–¹æ³•</strong></p>
<p>**æ›´æ–°canvasRendererçš„æè´¨å’Œçº¹ç†ã€‚**åœ¨ç»™canvasRendererè®¾ç½®æè´¨æ—¶ï¼Œä¼šéå†æ‰€æœ‰IMaterialModifierç±»å‹çš„ç»„ä»¶ï¼Œè°ƒç”¨IMaterialModifier.GetModifiedMaterialæ–¹æ³•ï¼Œç”¨äºé‡å»ºå›¾åƒæ—¶ï¼Œè·å–ä¿®æ”¹åçš„Materialï¼Œæ¥å®ç°é®ç½©æ•ˆæœã€‚</p>
<h3 id="é‡å»ºæ€»ç»“"><a href="#é‡å»ºæ€»ç»“" class="headerlink" title="é‡å»ºæ€»ç»“"></a>é‡å»ºæ€»ç»“</h3><ul>
<li><p>åœ¨UGUIä¸­ï¼Œç½‘æ ¼çš„æ›´æ–°æˆ–é‡å»ºï¼ˆä¸ºäº†å°½å¯èƒ½åˆå¹¶UIéƒ¨åˆ†çš„DrawCallï¼‰æ˜¯ä»¥Canvasä¸ºå•ä½çš„ï¼Œä¸”åªåœ¨å…¶ä¸­çš„UIå…ƒç´ å‘ç”Ÿå˜åŠ¨ï¼ˆä½ç½®ã€é¢œè‰²ç­‰ï¼‰æ—¶æ‰ä¼šè¿›è¡Œã€‚å› æ­¤ï¼Œå°†<strong>åŠ¨æ€UIå…ƒç´ ä¸é™æ€UIå…ƒç´ åˆ†ç¦»</strong>åï¼Œå¯ä»¥å°†åŠ¨æ€UIå…ƒç´ çš„å˜åŒ–æ‰€å¼•èµ·çš„ç½‘æ ¼æ›´æ–°æˆ–é‡å»ºæ‰€æ¶‰åŠåˆ°çš„èŒƒå›´å˜å°ï¼Œä»è€Œé™ä½ä¸€å®šçš„å¼€é”€ã€‚</p>
</li>
<li><p>é‡å»ºä¸­æ›´æ–°æŒ‡çš„æ˜¯UIå…ƒç´ æœ¬èº«çš„æŸäº›å±æ€§å‘ç”Ÿå˜åŒ–ï¼Œä»è€Œéœ€è¦é‡æ–°ç”Ÿæˆï¼Œæˆ–è€…æ›´æ–°é¡¶ç‚¹å±æ€§ã€‚æ¯”å¦‚é¢œè‰²å˜äº†ï¼Œåœ¨UGUIä¸­é¢œè‰²çš„å˜åŒ–æ˜¯é€šè¿‡ä¿®æ”¹é¡¶ç‚¹è‰²å®ç°çš„ï¼Œæ‰€ä»¥å°±éœ€è¦æ›´æ–°UIå…ƒç´ å¯¹åº”çš„æ¯ä¸ªé¡¶ç‚¹çš„é¡¶ç‚¹è‰²å±æ€§ï¼ˆå¯ä»¥è®¤ä¸ºå°±æ˜¯ä¿®æ”¹ä¸‹æŸä¸ªæ•°ç»„é‡Œçš„æ•°å€¼ï¼‰ã€‚</p>
<p> UIå…ƒç´ å’Œåˆ«çš„ç½‘æ ¼ä¸åŒç‚¹åœ¨äºï¼ŒUIçš„ç½‘æ ¼æ˜¯éœ€è¦è¿›è¡Œ<strong>åˆå¹¶</strong>çš„ï¼Œå¹¶ä¸”åœ¨UGUIä¸­æ˜¯<strong>ä»¥Canvasä¸ºå•ä½</strong>çš„ï¼Œåœ¨æäº¤GPUä¹‹å‰ï¼ŒåŒä¸€Canvasä¸‹çš„æ‰€æœ‰UIå…ƒç´ éƒ½ä¼šè¢«åˆå…¥ä¸€ä¸ªMeshä¸­ï¼ˆä½†åŒ…å«å¤šä¸ªSubMeshï¼‰ã€‚</p>
<p>æ‰€ä»¥ä½ç½®çš„ç§»åŠ¨ï¼Œé¡¶ç‚¹å±æ€§çš„å˜åŒ–ï¼Œéƒ½ä¼š<strong>å¯¼è‡´è¿™ä¸ªMeshè¦é‡æ–°åˆå¹¶</strong>ï¼Œä¹Ÿå°±æ˜¯ç½‘æ ¼é‡å»ºã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆè¯´è¦â€œåŠ¨é™åˆ†ç¦»â€çš„åŸå› ï¼Œå®Œå…¨é™æ€çš„Canvasæ˜¯ä¸éœ€è¦é‡å»ºçš„ï¼Œä½†åªè¦é‡Œé¢æœ‰ä¸€ä¸ªUIå…ƒç´ åœ¨åŠ¨ï¼Œå°±ä¼šå¼•èµ·Canvasçš„é‡å»ºã€‚</p>
</li>
<li><p>åœ¨UGUIé‡Œæ›´æ”¹äº†Imageçš„Colorå±æ€§ï¼Œå…¶åŸç†æ˜¯ä¿®æ”¹é¡¶ç‚¹è‰²ï¼Œå› æ­¤æ˜¯ä¼šå¼•èµ·ç½‘æ ¼çš„Rebuildçš„ã€‚é€šè¿‡ä¿®æ”¹é¡¶ç‚¹è‰²æ¥å®ç°UIå…ƒç´ å˜è‰²çš„å¥½å¤„åœ¨äºï¼Œ<strong>ä¿®æ”¹é¡¶ç‚¹è‰²å¯ä»¥ä¿è¯å…¶æè´¨ä¸å˜ï¼Œå› æ­¤ä¸ä¼šäº§ç”Ÿé¢å¤–çš„Draw Call</strong>ã€‚åœ¨UIçš„é»˜è®¤Shaderä¸­å­˜åœ¨ä¸€ä¸ªTint Colorçš„å˜é‡ï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œè¯¥å€¼ä¸ºå¸¸æ•°(1,1,1)ï¼Œä¸”å¹¶ä¸ä¼šè¢«ä¿®æ”¹ã€‚å¦‚æœæ˜¯ç”¨è„šæœ¬è®¿é—®Imageçš„Materialï¼Œå¹¶ä¿®æ”¹å…¶ä¸Šçš„Tint Colorå±æ€§æ—¶ï¼Œå¯¹UIå…ƒç´ äº§ç”Ÿçš„ç½‘æ ¼ä¿¡æ¯å¹¶æ²¡æœ‰å½±å“ï¼Œå› æ­¤å°±ä¸ä¼šå¼•èµ·ç½‘æ ¼çš„Rebuildã€‚ä½†è¿™æ ·åšå› ä¸ºä¿®æ”¹äº†æè´¨ï¼Œæ‰€ä»¥ä¼šå¢åŠ ä¸€ä¸ªDraw Callã€‚ï¼ˆï¼Ÿ</p>
</li>
</ul>
<h2 id="å±‚çº§"><a href="#å±‚çº§" class="headerlink" title="å±‚çº§"></a>å±‚çº§</h2><p>UGUIçš„å±‚å é¡ºåºæ˜¯æŒ‰ç…§Hierarchyä¸­çš„é¡ºåºä»ä¸Šå¾€ä¸‹è¿›è¡Œçš„ï¼Œä¹Ÿå°±æ˜¯è¶Šé ä¸Šçš„ç»„ä»¶ï¼Œå°±ä¼šè¢«ç»˜åˆ¶åœ¨è¶Šåº•éƒ¨ã€‚</p>
<ul>
<li><p>æ¸²æŸ“é¡ºåº</p>
</li>
<li><p>Unity3dä¸­çš„æ¸²æŸ“é¡ºåºå¦‚ä¸‹ï¼š<br> ä¸åŒçš„<strong>Camera</strong>çš„Depth<br> ç›¸åŒCameraä¸‹çš„ä¸åŒSortingLayer<br> ç›¸åŒ<strong>SortingLayer</strong>ä¸‹çš„ä¸åŒZè½´&#x2F;Order in Layer</p>
</li>
<li><p>æ”¹å˜æ§ä»¶ä¹‹é—´çš„å±‚çº§å…³ç³»</p>
<ol>
<li>åŒä¸€canvasä¸‹ï¼š<br>   æ”¹å˜æ§ä»¶transformçš„SiblingIndex,<br>   transform.GetSiblingIndex();<br>   transform.SetSiblingIndex(int index); &#x2F;&#x2F;indexå€¼è¶Šå¤§ï¼Œè¶Šåæ¸²æŸ“ï¼Œå±‚çº§è¶Šå¤§ï¼Œè¶Šæ˜¾ç¤ºåœ¨å‰é¢</li>
<li>ä¸åŒCanvasä¸‹ï¼š<br>  è®¾ç½®Canvasä¸‹çš„Sort Order &#x2F;&#x2F;Sort Orderå€¼è¶Šå¤§ï¼Œè¶Šåæ¸²æŸ“ï¼Œå±‚çº§è¶Šå¤§ï¼Œè¶Šæ˜¾ç¤ºåœ¨å‰é¢</li>
</ol>
</li>
</ul>
<hr>
<p>åˆ›å»ºä»»æ„UGUIå…ƒç´ æ—¶è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªCanvasç‰©ä½“ï¼ŒCanvasä¸‹çš„æ‰€æœ‰ç‰©ä½“ä»ä¸Šå¾€ä¸‹æ¸²æŸ“ï¼Œå³æ’åœ¨ä¸‹é¢çš„ä¼šé®ç›–æ’ä¸Šé¢çš„ã€‚åŒç†ï¼Œå­å…ƒç´ ä¼šè¦†ç›–çˆ¶å…ƒç´ ã€‚</p>
<p>åœ¨æ¸¸æˆè¿è¡Œä¸­å¦‚ä½•ä¿®æ”¹UGUIçš„æ˜¾ç¤ºå±‚çº§ï¼Ÿ<br>åœ¨ä»£ç ä¸­è°ƒæ•´è¯¥å…ƒç´ çš„å±‚çº§ä½ï¼šä½¿ç”¨RectTransformç±»çš„å‡½æ•°ã€‚</p>
<ul>
<li>SetAsFirstSiblingï¼šç§»åŠ¨åˆ°æ‰€æœ‰å…„å¼ŸèŠ‚ç‚¹çš„ç¬¬ä¸€ä¸ªä½ç½®ï¼ˆHierarchyåŒçº§æœ€ä¸Šé¢ï¼Œå…ˆæ¸²æŸ“ï¼Œæ˜¾ç¤ºåœ¨æœ€ä¸‹é¢ï¼‰</li>
<li>SetAsLastSiblingï¼šç§»åŠ¨åˆ°æ‰€æœ‰å…„å¼ŸèŠ‚ç‚¹çš„æœ€åä¸€ä¸ªä½ç½®ï¼ˆHierarchyåŒçº§æœ€ä¸‹é¢ï¼Œåæ¸²æŸ“ï¼Œæ˜¾ç¤ºåœ¨æœ€ä¸Šé¢ï¼‰</li>
<li>GetSiblingIndexï¼šè·å¾—è¯¥å…ƒç´ åœ¨å½“å‰å…„å¼ŸèŠ‚ç‚¹å±‚çº§çš„ä½ç½®</li>
<li>SetSiblingIndexï¼šè®¾ç½®è¯¥å…ƒç´ åœ¨å½“å‰å…„å¼ŸèŠ‚ç‚¹å±‚çº§çš„ä½ç½®</li>
</ul>
<h2 id="è£å‰ª"><a href="#è£å‰ª" class="headerlink" title="è£å‰ª"></a>è£å‰ª</h2><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/339378916">ã€è¯¦ç»†è§£æç‰ˆã€‘Unity UGUI Maskç»„ä»¶å®ç°åŸç† - çŸ¥ä¹ (zhihu.com)</a></p>
<blockquote>
<p>å¦ï¼šæ¨¡æ¿æµ‹è¯•è¯¦è§£çœ‹UnityShaderåˆçº§å…¥é—¨ç¯‡ã€‚</p>
</blockquote>
<p>ä¸¤ä¸ªæ–¹å¼ï¼ŒRect2DMaskå’Œmaskï¼Œåªå¯¹å­èŠ‚ç‚¹ç”Ÿæ•ˆï¼Œç†è®ºä¸Šå¯ä»¥æ”¹æºç ï¼Œä¸€èˆ¬æ²¡å•¥å¿…è¦æ”¹ã€‚</p>
<p><strong>RectMask2D</strong></p>
<p>åªèƒ½é®æŒ¡çŸ©å½¢èŒƒå›´ï¼Œç±»ä¼¼NGUIpanelçš„è£å‰ªæ–¹å¼ã€‚è¿™ç§æ–¹å¼<strong>ä¸å¢åŠ drawcall</strong>ï¼Œæ¯”maskæ€§èƒ½é«˜äº›ï¼Œä½†æ˜¯åªèƒ½é®æŒ¡çŸ©å½¢åŒºåŸŸã€‚</p>
<p>shaderéƒ¨åˆ†ï¼Œå®šä¹‰UNITY_UI_CLIP_RECTï¼Œcolor.a *&#x3D; UnityGet2DClipping(IN.worldPosition.xy, _ClipRect);å®ç°è£å‰ªã€‚</p>
<p>ä»£ç éƒ¨åˆ†ï¼Œè°ƒç”¨CanvasRendererçš„EnableRectClippingæ–¹æ³•ï¼Œä¼ é®æŒ¡åŒºåŸŸï¼Œåº•å±‚è®¾ç½®ç»™_ClipRectã€‚</p>
<p>RectMask2DèŠ‚ç‚¹ä¸‹çš„maskableç»„ä»¶ï¼Œæ³¨å†Œåˆ°ClipperRegistryç±»ï¼Œåº•å±‚æ§åˆ¶å¯¹åº”çš„shaderæ‰“å¼€å®å®šä¹‰ã€‚</p>
<p><strong>Mask</strong></p>
<p>åŸç†è®¾ç½®æ¨¡æ¿ç¼“å†²å€¼ï¼Œé€šè¿‡æµ‹è¯•çš„åƒç´ æ‰èƒ½æ˜¾ç¤ºï¼Œä»è€Œåªåœ¨æŒ‡å®šèŒƒå›´å†…æ˜¾ç¤ºå›¾åƒã€‚é€æ˜åº¦ä¸º0çš„åŒºåŸŸä¸æ˜¾ç¤ºã€‚</p>
<ul>
<li>å®ç°æ–¹å¼</li>
</ul>
<p>å°†æ¸²æŸ“åˆ†3ä¸ªæ­¥éª¤ï¼Œé¦–å…ˆæ¸²æŸ“maskï¼Œè®¾ç½®æ¨¡æ¿ç¼“å†²çš„å€¼ï¼Œç„¶åæ¸²æŸ“æ¨¡æ¿ä¸‹çš„å¯¹è±¡ï¼Œåˆ¤æ–­æ¨¡æ¿ç¼“å†²å€¼ï¼Œç›¸åŒæ‰æ¸²æŸ“ï¼Œä¹Ÿå°±æ˜¯åœ¨æ ¹èŠ‚ç‚¹å®šä¹‰çš„åŒºåŸŸå†…ï¼ˆMaskå­ç‰©ä½“ä¸­ï¼‰æ¸²æŸ“ï¼Œæœ€åå°†æ¨¡æ¿ç¼“å†²åŒºè®¾ç½®ä¸º0ã€‚</p>
<ul>
<li>åŸç†</li>
</ul>
<ol>
<li><p>Maskå¯¹è±¡æœ‰æ¨¡æ¿æµ‹è¯•ï¼š</p>
<p>Maskçš„å…³é”®ä»£ç å…¶å®åªæœ‰ä¸€è¡Œï¼Œå¦‚ä¸‹ï¼ˆä¸ºæ–¹ä¾¿ç†è§£ï¼Œå¯¹ä»£ç åšäº†ç®€åŒ–å¤„ç†ï¼‰ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> maskMaterial = StencilMaterial.Add(baseMaterial, <span class="number">1</span>, StencilOp.Replace, CompareFunction.Always);</span><br></pre></td></tr></table></figure>

<p>å®ƒçš„ä½œç”¨æ˜¯<strong>ä¸ºMaskå¯¹è±¡ç”Ÿæˆä¸€ä¸ªç‰¹æ®Šçš„æè´¨ï¼Œè¿™ä¸ªæè´¨ä¼šå°†StencilBufferçš„å€¼ç½®ä¸º1</strong>ã€‚</p>
</li>
<li><p>éœ€è¦é®ç½©æ•ˆæœçš„å¯¹è±¡ä¹Ÿæœ‰æ¨¡æ¿æµ‹è¯•ï¼š</p>
<p>åŒæ ·çš„ï¼Œåœ¨Imageï¼ŒTextå’ŒRawImageçš„åŸºç±» MaskableGraphic ä¸­ï¼Œæœ‰è¿™æ ·ä¸€è¡Œå…³é”®ä»£ç ï¼ˆä¸ºæ–¹ä¾¿ç†è§£ï¼Œå¯¹ä»£ç åšäº†ç®€åŒ–å¤„ç†ï¼‰ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> maskMat = StencilMaterial.Add(baseMaterial, <span class="number">1</span>, StencilOp.Keep, CompareFunction.Equal, <span class="number">1</span>, <span class="number">0</span>);</span><br></pre></td></tr></table></figure>

<p>å®ƒçš„ä½œç”¨æ˜¯<strong>ä¸ºMaskableGraphicç”Ÿæˆä¸€ä¸ªç‰¹æ®Šçš„æè´¨ï¼Œè¿™ä¸ªæè´¨åœ¨æ¸²æŸ“æ—¶ä¼šå–å‡ºStencilBufferçš„å€¼ï¼Œåˆ¤æ–­æ˜¯å¦ä¸º1ï¼Œå¦‚æœæ˜¯æ‰è¿›è¡Œæ¸²æŸ“ã€‚</strong></p>
</li>
</ol>
<blockquote>
<p>ä¸Šè¿°å¯¹StencilBufferçš„æ“ä½œæ˜¯é€åƒç´ çš„ï¼Œè¿™æ ·å³è¾¾åˆ°äº†Maskçš„æ•ˆæœã€‚</p>
<p>ç®€å•æ¥è¯´ï¼Œ<strong>gpuä¸ºæ¯ä¸ªåƒç´ ç‚¹åˆ†é…ä¸€ä¸ªç§°ä¹‹ä¸ºstencil bufferçš„1å­—èŠ‚å¤§å°çš„å†…å­˜åŒºåŸŸï¼Œè¿™ä¸ªåŒºåŸŸå¯ä»¥ç”¨äºä¿å­˜æˆ–ä¸¢å¼ƒåƒç´ çš„ç›®çš„ã€‚</strong></p>
</blockquote>
<ul>
<li>ç¼ºç‚¹</li>
</ul>
<ol>
<li>æ‰“ä¹±åˆæ‰¹ã€‚</li>
<li>åœ†å½¢è¾¹ç¼˜é”¯é½¿æ˜æ˜¾ï¼ŒåŸå› æ˜¯å¹¶ä¸æ”¯æŒè¾¹ç¼˜æ¸å˜ï¼Œåªæœ‰æ˜¾ç¤ºå’Œä¸æ˜¾ç¤ºä¸¤ä¸ªçŠ¶æ€ã€‚</li>
<li>é®æŒ¡æ•ˆæœåªæ˜¯æ˜¾ç¤ºï¼Œç‚¹å‡»é€»è¾‘è¿˜æ˜¯å®Œæ•´çš„åŒºåŸŸï¼Œä¸€èˆ¬å¸¸ç”¨çš„ï¼Œæ‰©å±•ä¸€ä¸ªå›¾å½¢æ›´å¥½ï¼Œæ¯”å¦‚åœ†å½¢</li>
</ol>
<h2 id="å›¾é›†"><a href="#å›¾é›†" class="headerlink" title="å›¾é›†"></a>å›¾é›†</h2><h2 id="è¾“å…¥ç³»ç»Ÿ"><a href="#è¾“å…¥ç³»ç»Ÿ" class="headerlink" title="è¾“å…¥ç³»ç»Ÿ"></a>è¾“å…¥ç³»ç»Ÿ</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/woodengm/article/details/123393108">Unityä¸­çš„UGUIæºç è§£æä¹‹äº‹ä»¶ç³»ç»Ÿ(1)-æ¦‚è¿°_unityäº‹ä»¶ç³»ç»Ÿæºç _æ‹‚é¢æ¸…é£ä¸‰ç‚¹æ°´çš„åšå®¢-CSDNåšå®¢</a></p>
<p>å¹¿ä¹‰çš„<strong>äº‹ä»¶ç³»ç»Ÿ</strong>æ˜¯æŒ‡Unityä¸­æ•´ä¸ªäº‹ä»¶ç›¸å…³çš„ä¸€æ•´ä¸ªç³»ç»Ÿ, è€Œç‹­ä¹‰çš„<strong>äº‹ä»¶ç³»ç»Ÿ</strong>æŒ‡çš„æ˜¯ä¸€ä¸ªä¸“é—¨çš„ç»„ä»¶: <strong>EventSystem</strong>.</p>
<h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p><strong>äº‹ä»¶ç³»ç»Ÿ</strong>ä¸»è¦è´Ÿè´£:</p>
<ul>
<li>å¤„ç†è¾“å…¥</li>
<li>å°„çº¿æŠ•å°„</li>
<li>å‘é€äº‹ä»¶</li>
</ul>
<p><strong>äº‹ä»¶ç³»ç»Ÿ</strong>ä¸»è¦ç”±ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ç»„æˆ:ï¼ˆæ•´ä¸ª<strong>äº‹ä»¶ç³»ç»Ÿ</strong>ç”±å¾ˆå¤šè§’è‰²ç»„æˆ, äº’ç›¸åä½œæ¥å®Œæˆäº‹ä»¶ç›¸å…³å·¥ä½œ.ï¼‰</p>
<ul>
<li><code>EventSystem</code>ç»„ä»¶</li>
<li>è¾“å…¥æ¨¡å—(InputModule): <code>BaseInputModule</code>å’Œå…¶å­ç±»</li>
<li>å°„çº¿æŠ•å°„å™¨(Raycaster)</li>
<li>æ¶ˆæ¯ç³»ç»Ÿ</li>
<li>å„ç§æ”¯æŒçš„äº‹ä»¶</li>
<li>äº‹ä»¶è§¦å‘å™¨(EventTrigger)</li>
</ul>
<h3 id="EventSystem"><a href="#EventSystem" class="headerlink" title="EventSystem"></a>EventSystem</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/woodengm/article/details/123416615">Unityä¸­çš„UGUIæºç è§£æä¹‹äº‹ä»¶ç³»ç»Ÿ(2)-EventSystemç»„ä»¶_unity eventsystem raycastcomparer_æ‹‚é¢æ¸…é£ä¸‰ç‚¹æ°´çš„åšå®¢-CSDNåšå®¢</a></p>
<p><strong>EventSystem</strong>ç›¸å½“äº<strong>äº‹ä»¶ç³»ç»Ÿçš„ç®¡ç†å™¨</strong>, è´Ÿè´£åè°ƒå„ä¸ªæ¨¡å—.</p>
<p><strong>EventSystem</strong>ä¸»è¦è´Ÿè´£:</p>
<ul>
<li><strong>äº‹ä»¶ç³»ç»Ÿ</strong>å¯¹å¤–çš„æ¥å£</li>
<li>è´Ÿè´£å„ä¸ªäº‹ä»¶ç›¸å…³æ¨¡å—ä¹‹é—´é€šè®¯çš„ç®¡ç†å’Œåè°ƒ</li>
<li>ç®¡ç†é€‰ä¸­çš„æ¸¸æˆå¯¹è±¡</li>
<li>ç®¡ç†æ­£åˆ™ä½¿ç”¨çš„è¾“å…¥æ¨¡å—</li>
<li>ç®¡ç†å°„çº¿æŠ•å°„</li>
<li>æ ¹æ®éœ€è¦æ›´æ–°æ‰€æœ‰çš„è¾“å…¥æ¨¡å—</li>
</ul>
<p><strong>EventSystem</strong>éœ€è¦ä¸å…¶å®ƒç»„ä»¶ååŒå·¥ä½œ, æ ¹æ®ä»»åŠ¡ä¸åŒ, æ­é…çš„ç»„ä»¶ä¸åŒ, Unityå»ºè®®æˆ‘ä»¬ä¸€ä¸ªåœºæ™¯åªæœ‰ä¸€ä¸ª<strong>EventSystem</strong>, å½“ç„¶, è¿™å¹¶ä¸æ˜¯å¼ºåˆ¶è¦æ±‚.</p>
<p>åœ¨ä¸€ä¸ªåœºæ™¯ä¸­æ·»åŠ ä»»æ„çš„UIæ§ä»¶, ä¼šé»˜è®¤æ·»åŠ ä¸€ä¸ªEventSystemå¯¹è±¡, èº«ä¸ŠæŒ‚è½½EventSystemç»„ä»¶å’Œä¸€ä¸ªStandaloneInputModule(ç‹¬ç«‹è¾“å…¥æ¨¡å—)ç»„ä»¶. å„ç§äº‹ä»¶è¦ç”Ÿæ•ˆ, åœºæ™¯ä¸­è‡³å°‘éœ€è¦ä¸€ä¸ªEventSystem. ä½†æ˜¯ä¹Ÿå¯ä»¥å­˜åœ¨å¤šä¸ª, ä½†æ˜¯åªä¼šç”Ÿæ•ˆä¸€ä¸ª.</p>
<blockquote>
<p>Unityé»˜è®¤ä¼šä»æŒ‚è½½<strong>EventSystem</strong>ç»„ä»¶çš„å¯¹è±¡ä¸ŠæŸ¥æ‰¾è¾“å…¥æ¨¡å—å¹¶æ·»åŠ åˆ°å…¶å†…éƒ¨åˆ—è¡¨ä¸­è¿›è¡Œç®¡ç†å’Œé…åˆä½¿ç”¨.</p>
</blockquote>
<h3 id="è¾“å…¥æ¨¡å—-InputModule"><a href="#è¾“å…¥æ¨¡å—-InputModule" class="headerlink" title="è¾“å…¥æ¨¡å—(InputModule)"></a>è¾“å…¥æ¨¡å—(InputModule)</h3><p>è¾“å…¥æ¨¡å—ä¸»è¦å¤„ç†è¾“å…¥, ä¹Ÿæ˜¯æ•´ä¸ª<strong>äº‹ä»¶ç³»ç»Ÿ</strong>çš„ä¸»è¦éƒ¨åˆ†, Unityæä¾›äº†ä¸‹é¢çš„å‡ ä¸ªç±»æ¥æŠ½è±¡è¾“å…¥çš„å¤„ç†:</p>
<ul>
<li><strong>BaseInputModule</strong>:æ•´ä¸ªè¾“å…¥æ¨¡å—çš„åŸºç±»</li>
<li><strong>PointerInputModule : BaseInputModule</strong>: å¤„ç†<u>æŒ‡é’ˆè®¾å¤‡è¾“å…¥</u>çš„åŸºç±»</li>
<li><strong>StandaloneInputModule: PointerInputModule</strong>: ç‹¬ç«‹è¾“å…¥æ¨¡å—, ç›®å‰æ˜¯ä¸»è¦çš„è¾“å…¥å¤„ç†æ¨¡å—</li>
<li>TouchInputModule : PointerInputModule: å¤„ç†è§¦æ‘¸äº‹ä»¶è¾“å…¥, (å·²ç»åºŸå¼ƒ, å†…å®¹åŒ…å«åˆ°StandaloneInputModuleä¸­)</li>
</ul>
<blockquote>
<p>æŒ‡é’ˆè¾“å…¥(PointerInput)ï¼š</p>
<p><strong>æŒ‡é’ˆè¾“å…¥è®¾å¤‡</strong>æŒ‡çš„æ˜¯é‚£äº›åœ¨2dè¡¨é¢è¿½è¸ªè¾“å…¥ä½ç½®çš„è®¾å¤‡, äº‹ä»¶ç³»ç»Ÿæ”¯æŒçš„æŒ‡é’ˆè¾“å…¥æœ‰: <strong>è§¦æ‘¸, é¼ æ ‡å’Œè§¦æ§ç¬”</strong>. <a target="_blank" rel="noopener" href="https://docs.unity3d.com/Packages/com.unity.inputsystem@1.0/manual/Pointers.html">è¯¦æƒ…åœ¨è¿™é‡Œ</a>. è™½ç„¶è¿™é‡Œé¢è®²çš„æ˜¯æ–°çš„è¾“å…¥ç³»ç»Ÿ, ä½†æ˜¯æ¦‚å¿µæ˜¯ä¸€æ ·çš„, ä¸å½±å“ç†è§£.</p>
</blockquote>
<h3 id="å°„çº¿æŠ•å°„å™¨ï¼ˆRaycasterï¼‰"><a href="#å°„çº¿æŠ•å°„å™¨ï¼ˆRaycasterï¼‰" class="headerlink" title="å°„çº¿æŠ•å°„å™¨ï¼ˆRaycasterï¼‰"></a>å°„çº¿æŠ•å°„å™¨ï¼ˆRaycasterï¼‰</h3><p>è¿™å°±æ˜¯ç»å¸¸å¬åˆ°çš„å°„çº¿æ£€æµ‹å™¨, åŸç†æ˜¯åœ¨ç‚¹å‡»æˆ–è€…è§¦æ‘¸çš„ä½ç½®å‘å°„ä¸€æ¡å°„çº¿, ç„¶åæ”¶é›†æ‰€æœ‰è¢«å°„çº¿ç©¿é€çš„å¯¹è±¡, ç„¶åè¿”å›æœ€å¯èƒ½(æ¯”å¦‚æœ€æ¥è¿‘å±å¹•çš„å¯¹è±¡)çš„ç›®æ ‡. ä¾›<strong>äº‹ä»¶ç³»ç»Ÿ</strong>ä½¿ç”¨.</p>
<p>Unityæä¾›äº†ä¸‰ç§å°„çº¿æŠ•å°„å™¨:</p>
<ul>
<li><strong>å›¾å½¢å°„çº¿æŠ•å°„å™¨ (Graphic Raycaster)</strong>, ä¸€èˆ¬ç”¨äºUIå…ƒç´ , å¸¸æŒ‚è½½åœ¨Canvasä¸Š, ç”¨äºéå†è¯¥Canvasçš„å„ä¸ªå…ƒç´ . å°±æ˜¯è¯´æ²¡æœ‰è¿™ä¸ªç»„ä»¶å°±æ— æ³•è§¦å‘å„ç§UIäº‹ä»¶.</li>
<li><strong>2D ç‰©ç†å°„çº¿æŠ•å°„å™¨ (Physics 2D Raycaster)</strong>, ç”¨äº<u>2Dç‰©ç†å…ƒç´ </u>çš„æ£€æµ‹, éœ€è¦å¯¹è±¡èº«ä¸Šæœ‰ç¢°æ’ç›’å­(Collider)</li>
<li><strong>ç‰©ç†å°„çº¿æŠ•å°„å™¨ (Physics Raycaster)</strong> - ç”¨äº 3D ç‰©ç†å…ƒç´ , éœ€è¦å¯¹è±¡èº«ä¸Šæœ‰ç¢°æ’ç›’å­(Collider)</li>
</ul>
<p>åªè¦åœºæ™¯ä¸­å­˜åœ¨å°„çº¿æŠ•å°„å™¨, ç„¶åä»è¾“å…¥æ¨¡å—å‘å‡ºæ£€æµ‹è¯·æ±‚, é‚£ä¹ˆäº‹ä»¶ç³»ç»Ÿå°±ä¼šä½¿ç”¨å®ƒ, è¿™æ˜¯é€šè¿‡å°„çº¿ç®¡ç†å™¨(<code>RaycasterManager</code>)æ¥å®ç°çš„.</p>
<h3 id="æ¶ˆæ¯ç³»ç»Ÿ"><a href="#æ¶ˆæ¯ç³»ç»Ÿ" class="headerlink" title="æ¶ˆæ¯ç³»ç»Ÿ"></a>æ¶ˆæ¯ç³»ç»Ÿ</h3><p>UGUIä½¿ç”¨äº†æ–°çš„æ¶ˆæ¯ç³»ç»Ÿæ¥å¤„ç†<strong>æ¶ˆæ¯åˆ†å‘</strong>, è¿™ä¸ªå®ç°å¾ˆå·§å¦™, æ²¡æœ‰ä½¿ç”¨å¸¸è§„çš„æ˜¾å¾—æ¯”è¾ƒç¹é‡çš„æ¶ˆæ¯ç³»ç»Ÿ, </p>
<p>è€Œæ˜¯ä½¿ç”¨äº†ä¸€ä¸ªé™æ€çš„ç±»ExecuteEventså’Œä¸€ä¸ªæ¶ˆæ¯æ¥å£IEventSystemHandler, é€šè¿‡æ¯æ¬¡åˆ†å‘æ—¶æŸ¥è¯¢å¯¹è±¡èº«ä¸Šçš„<strong>å®ç°äº†IEventSystemHandleræ¥å£</strong>çš„æ‰€æœ‰ç»„ä»¶, ç„¶åå‘è¿™äº›ç»„ä»¶åˆ†å‘æ¶ˆæ¯, æ¶ˆæ¯ç³»ç»Ÿæœ¬èº«ä¸ç»´æŠ¤æ¶ˆæ¯å’Œå…¶å¤„ç†å™¨.</p>
<h3 id="å„ç§æ”¯æŒçš„äº‹ä»¶"><a href="#å„ç§æ”¯æŒçš„äº‹ä»¶" class="headerlink" title="å„ç§æ”¯æŒçš„äº‹ä»¶"></a>å„ç§æ”¯æŒçš„äº‹ä»¶</h3><p>äº‹ä»¶ç³»ç»Ÿæ‰€æœ‰çš„äº‹ä»¶éƒ½å®ç°<code>IEventSystemHandler</code>æ¥å£, è¿™æ˜¯æ¶ˆæ¯ç³»ç»Ÿçš„åŸºç¡€, Unityæä¾›äº†ä»¥ä¸‹<strong>äº‹ä»¶</strong>:</p>
<blockquote>
<p>æ¥æ”¶å¯¹åº”äº‹ä»¶å¹¶<strong>æ‰§è¡Œ</strong>è‡ªå·±çš„è‡ªå®šä¹‰å“åº”æ–¹æ³•ã€‚</p>
</blockquote>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">IPointerEnterHandler - OnPointerEnter <span class="comment">// å½“æŒ‡é’ˆè¿›å…¥å¯¹è±¡æ—¶è°ƒç”¨</span></span><br><span class="line">IPointerExitHandler - OnPointerExit <span class="comment">// å½“æŒ‡é’ˆé€€å‡ºå¯¹è±¡æ—¶è°ƒç”¨</span></span><br><span class="line">IPointerDownHandler - OnPointerDown <span class="comment">// åœ¨å¯¹è±¡ä¸ŠæŒ‰ä¸‹æŒ‡é’ˆæ—¶è°ƒç”¨</span></span><br><span class="line">IPointerUpHandler - OnPointerUp - <span class="function">Called <span class="keyword">when</span> a pointer <span class="keyword">is</span> <span class="title">released</span> (<span class="params">called <span class="keyword">on</span> the original the pressed <span class="built_in">object</span></span>)</span></span><br><span class="line"><span class="function">IPointerClickHandler - OnPointerClick - åœ¨åŒä¸€å¯¹è±¡ä¸ŠæŒ‰ä¸‹å†æ¾å¼€æŒ‡é’ˆæ—¶è°ƒç”¨</span></span><br><span class="line"><span class="function">IInitializePotentialDragHandler - OnInitializePotentialDrag - åœ¨æ‰¾åˆ°æ‹–åŠ¨ç›®æ ‡æ—¶è°ƒç”¨ï¼Œå¯ç”¨äºåˆå§‹åŒ–å€¼</span></span><br><span class="line"><span class="function">IBeginDragHandler - OnBeginDrag - å³å°†å¼€å§‹æ‹–åŠ¨æ—¶åœ¨æ‹–åŠ¨å¯¹è±¡ä¸Šè°ƒç”¨</span></span><br><span class="line"><span class="function">IDragHandler - OnDrag - å‘ç”Ÿæ‹–åŠ¨æ—¶åœ¨æ‹–åŠ¨å¯¹è±¡ä¸Šè°ƒç”¨</span></span><br><span class="line"><span class="function">IEndDragHandler - OnEndDrag - æ‹–åŠ¨å®Œæˆæ—¶åœ¨æ‹–åŠ¨å¯¹è±¡ä¸Šè°ƒç”¨</span></span><br><span class="line"><span class="function">IDropHandler - OnDrop - åœ¨æ‹–åŠ¨ç›®æ ‡å¯¹è±¡ä¸Šè°ƒç”¨</span></span><br><span class="line"><span class="function">IScrollHandler - OnScroll - å½“é¼ æ ‡æ»šè½®æ»šåŠ¨æ—¶è°ƒç”¨</span></span><br><span class="line"><span class="function">IUpdateSelectedHandler - OnUpdateSelected - æ¯æ¬¡å‹¾é€‰æ—¶åœ¨é€‰å®šå¯¹è±¡ä¸Šè°ƒç”¨</span></span><br><span class="line"><span class="function">ISelectHandler - OnSelect - å½“å¯¹è±¡æˆä¸ºé€‰å®šå¯¹è±¡æ—¶è°ƒç”¨</span></span><br><span class="line"><span class="function">IDeselectHandler - OnDeselect - å–æ¶ˆé€‰æ‹©é€‰å®šå¯¹è±¡æ—¶è°ƒç”¨</span></span><br><span class="line"><span class="function">IMoveHandler - OnMove <span class="comment">// å‘ç”Ÿç§»åŠ¨äº‹ä»¶ï¼ˆä¸Šã€ä¸‹ã€å·¦ã€å³ç­‰ï¼‰æ—¶è°ƒç”¨</span></span></span><br><span class="line"><span class="function">ISubmitHandler - OnSubmit - æŒ‰ä¸‹ Submit æŒ‰é’®æ—¶è°ƒç”¨</span></span><br><span class="line"><span class="function">ICancelHandler - OnCancel - æŒ‰ä¸‹ Cancel æŒ‰é’®æ—¶è°ƒç”¨</span></span><br></pre></td></tr></table></figure>

<p>é€šè¿‡åœ¨Monobehaviorè„šæœ¬ä¸Šå®ç°è¿™äº›æ¥å£å°±èƒ½æ¥æ”¶äº‹ä»¶. ä¹Ÿå¯ä»¥ç›´æ¥å®ç°<code>IEventSystemHandler</code>æ¥å£, è‡ªå®šä¹‰æ¶ˆæ¯. ç¤ºä¾‹å¦‚ä¸‹:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> UnityEngine.EventSystems;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">NavigationEventTest</span> : <span class="title">MonoBehaviour</span>, <span class="title">IMoveHandler</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">OnMove</span>(<span class="params">AxisEventData eventData</span>)</span> &#123;</span><br><span class="line">		Debug.LogError(<span class="string">&quot;onMove: &quot;</span> + eventData);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ----------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">ICustomMessageTarget</span> : <span class="title">IEventSystemHandler</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// å¯é€šè¿‡æ¶ˆæ¯ç³»ç»Ÿè°ƒç”¨çš„å‡½æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Message1</span>(<span class="params"></span>)</span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Message2</span>(<span class="params"></span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">CustomMessageTarget</span> : <span class="title">MonoBehaviour</span>, <span class="title">ICustomMessageTarget</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Message1</span>(<span class="params"></span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Debug.Log (<span class="string">&quot;Message 1 received&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Message2</span>(<span class="params"></span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Debug.Log (<span class="string">&quot;Message 2 received&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ExecuteEvents.Execute&lt;ICustomMessageTarget&gt;(target, <span class="literal">null</span>, (x,y)=&gt;x.Message1());</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="äº‹ä»¶è§¦å‘å™¨-EventTrigger"><a href="#äº‹ä»¶è§¦å‘å™¨-EventTrigger" class="headerlink" title="äº‹ä»¶è§¦å‘å™¨(EventTrigger)"></a>äº‹ä»¶è§¦å‘å™¨(EventTrigger)</h3><p>ä¸Šé¢æ·»åŠ äº‹ä»¶çš„æ–¹å¼éœ€è¦è„šæœ¬å®ç°äº‹ä»¶æ¥å£, æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡äº‹ä»¶è§¦å‘å™¨æ¥æ‹¦æˆªæ‰€æœ‰äº‹ä»¶, å¤„ç†æˆ‘ä»¬æƒ³è¦å¤„ç†çš„äº‹ä»¶.</p>
<p>æœ‰ä¸¤ç§äº‹ä»¶äº‹ä»¶è§¦å‘å™¨çš„æ–¹å¼, ä¸€ä¸ªæ˜¯é€šè¿‡ç»§æ‰¿, ç„¶åé‡å†™æŒ‡å®šçš„äº‹ä»¶æ–¹æ³•, å¦‚ä¸‹:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> UnityEngine.EventSystems;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">EventTriggerExample</span> : <span class="title">EventTrigger</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnBeginDrag</span>(<span class="params">PointerEventData data</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Debug.Log(<span class="string">&quot;OnBeginDrag called.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnCancel</span>(<span class="params">BaseEventData data</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Debug.Log(<span class="string">&quot;OnCancel called.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦ä¸€ç§æ˜¯é€šè¿‡è®¾ç½®å§”æ‰˜çš„æ–¹å¼, å¦‚ä¸‹:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> UnityEngine.EventSystems;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">EventTriggerDelegateExample</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Start</span>(<span class="params"></span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        EventTrigger trigger = GetComponent&lt;EventTrigger&gt;();</span><br><span class="line">        EventTrigger.Entry entry = <span class="keyword">new</span> EventTrigger.Entry();</span><br><span class="line">        entry.eventID = EventTriggerType.PointerDown;</span><br><span class="line">        entry.callback.AddListener((data) =&gt; &#123; OnPointerDownDelegate((PointerEventData)data); &#125;);</span><br><span class="line">        trigger.triggers.Add(entry);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">OnPointerDownDelegate</span>(<span class="params">PointerEventData data</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Debug.Log(<span class="string">&quot;OnPointerDownDelegate called.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡äº‹ä»¶è§¦å‘å™¨çš„æ–¹å¼æ¥æ³¨å†Œå’Œå¤„ç†äº‹ä»¶æ›´åŠ çµæ´», ä½†æ˜¯ä¼šæ‹¦æˆªæ‰€æœ‰äº‹ä»¶, å¯¼è‡´äº‹ä»¶æ— æ³•ä¼ é€’åˆ°çˆ¶å¯¹è±¡, åœ¨ä½¿ç”¨çš„æ—¶å€™éœ€è¦æ³¨æ„.</p>
<p>ã€æ›´è¯¦ç»†çš„ç­‰é‡åˆ°å†æ·±å…¥äº†è§£ï¼Œè¿˜æœ‰æ›´è¯¦ç»†çš„åšå®¢åœ¨åŒä¸€ä¸ªä¸“æ ã€‘</p>
<h2 id="UGUIçš„äº‹ä»¶ä¼ é€’"><a href="#UGUIçš„äº‹ä»¶ä¼ é€’" class="headerlink" title="UGUIçš„äº‹ä»¶ä¼ é€’"></a>UGUIçš„äº‹ä»¶ä¼ é€’</h2><p><a target="_blank" rel="noopener" href="https://www.xuanyusong.com/archives/4241">Unity3Dç ”ç©¶é™¢ä¹‹å°†UIçš„ç‚¹å‡»äº‹ä»¶æ¸—é€ä¸‹å»ï¼ˆä¹åï¼‰ | é›¨æ¾MOMOç¨‹åºç ”ç©¶é™¢ (xuanyusong.com)</a></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> System.Collections;</span><br><span class="line"><span class="keyword">using</span> UnityEngine.EventSystems;</span><br><span class="line"><span class="keyword">using</span> UnityEngine.UI;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Test</span> : <span class="title">MonoBehaviour</span>,<span class="title">IPointerClickHandler</span> ,<span class="title">IPointerDownHandler</span>,<span class="title">IPointerUpHandler</span></span><br><span class="line">&#123; </span><br><span class="line"> </span><br><span class="line">    <span class="comment">//ç›‘å¬æŒ‰ä¸‹</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">OnPointerDown</span>(<span class="params">PointerEventData eventData</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        PassEvent(eventData,ExecuteEvents.pointerDownHandler);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">//ç›‘å¬æŠ¬èµ·</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">OnPointerUp</span>(<span class="params">PointerEventData eventData</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        PassEvent(eventData,ExecuteEvents.pointerUpHandler);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">//ç›‘å¬ç‚¹å‡»</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">OnPointerClick</span>(<span class="params">PointerEventData eventData</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        PassEvent(eventData,ExecuteEvents.submitHandler);</span><br><span class="line">        PassEvent(eventData,ExecuteEvents.pointerClickHandler);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="comment">//æŠŠäº‹ä»¶é€ä¸‹å»</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span>  <span class="title">PassEvent</span>&lt;<span class="title">T</span>&gt;(<span class="params">PointerEventData data,ExecuteEvents.EventFunction&lt;T&gt; function</span>)</span></span><br><span class="line"><span class="function">        <span class="keyword">where</span> T : IEventSystemHandler</span></span><br><span class="line">    &#123;</span><br><span class="line">        List&lt;RaycastResult&gt; results = <span class="keyword">new</span> List&lt;RaycastResult&gt;();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å‘å°„å°„çº¿ï¼Œè·å¾—è¢«å°„çº¿å‡»ä¸­çš„ç‰©ä½“</span></span><br><span class="line">        EventSystem.current.RaycastAll(data, results);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è‡ªå·±ï¼Ÿ</span></span><br><span class="line">        GameObject current = data.pointerCurrentRaycast.gameObject ;</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">for</span>(<span class="built_in">int</span> i =<span class="number">0</span>; i&lt; results.Count;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// é™¤äº†è‡ªå·±å…¶å®ƒè¢«å°„ä¸­çš„ç‰©ä½“éƒ½æ‰§è¡Œå“åº”</span></span><br><span class="line">            <span class="keyword">if</span>(current!= results[i].gameObject)</span><br><span class="line">            &#123;</span><br><span class="line">                ExecuteEvents.Execute(results[i].gameObject, data,function);</span><br><span class="line">                <span class="comment">//RaycastAllåuguiä¼šè‡ªå·±æ’åºï¼Œå¦‚æœä½ åªæƒ³å“åº”é€ä¸‹å»çš„æœ€è¿‘çš„ä¸€ä¸ªå“åº”ï¼Œè¿™é‡ŒExecuteEvents.Executeåç›´æ¥breakå°±è¡Œã€‚</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä»ç„¶éµå¾ªè¿™æ ·çš„æµç¨‹ï¼šè¾“å…¥ï¼ˆå„ç§ç±»å‹çš„è¾“å…¥ï¼‰-å°„çº¿æ£€æµ‹-è¢«æ£€æµ‹åˆ°çš„ç‰©ä½“ï¼ˆæ ¹æ®è¾“å…¥ç±»å‹ï¼‰æ‰§è¡Œäº‹ä»¶ã€‚</p>
<p>ç”±äºUnityé»˜è®¤æ˜¯æœ€è¿‘çš„å‘ç”Ÿå“åº”ï¼Œå¦‚æœæƒ³è¦éƒ½è¢«å“åº”å°±è¦æ‰‹åŠ¨å¤„ç†ï¼ˆï¼Ÿ</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://huangxinhere.github.io">(â—Ë‡âˆ€Ë‡â—)</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://huangxinhere.github.io/2023/09/01/%E7%9F%A5%E8%AF%86%E6%95%B4%E7%90%86-Unity-UI/">https://huangxinhere.github.io/2023/09/01/%E7%9F%A5%E8%AF%86%E6%95%B4%E7%90%86-Unity-UI/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº <a href="https://huangxinhere.github.io" target="_blank">Hx's blog</a>ï¼</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/img/unity.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2023/09/04/%E7%9F%A5%E8%AF%86%E6%95%B4%E7%90%86-C#-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95/" title="C#-æ•°æ®ç»“æ„å’Œç®—æ³•"><img class="cover" src="/img/%7D7Y%5B5BZE_KJVDX6TI%5D$9CY1.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">ä¸Šä¸€ç¯‡</div><div class="info-item-2">C#-æ•°æ®ç»“æ„å’Œç®—æ³•</div></div><div class="info-2"><div class="info-item-1">å­—å…¸åŸç†æµ…æC# Dictionaryå®ç°åŸç† - InCerry - åšå®¢å›­ (cnblogs.com)[æ›´æ¸…æ™°] ã€C#ã€‘æµ…æC# Dictionaryå®ç°åŸç† - çŸ¥ä¹ (zhihu.com) ä¸»è¦æ˜¯æ‹‰é“¾æ³•ã€‚ æ ¸å¿ƒæ˜¯bucketså’Œentriesæ•°ç»„ã€‚ã€å¦‚æœæœ‰æ‹‰é“¾æ³•ï¼Œèƒ½å¦é€ä¸€è®¿é—®æ‹‰é“¾ï¼Ÿã€‘  å°†é”®è½¬åŒ–æˆhashcodeä¹‹åï¼Œå–ä½™æ•°ï¼Œå¾—åˆ°å“ˆå¸Œå€¼ï¼Œæ‰¾åˆ°å“ˆå¸Œæ¡¶æ•°ç»„å¯¹åº”çš„ä½ç½®2 å°†ä¿¡æ¯å­˜å…¥åˆ°entriesæ•°ç»„ä¸­ï¼Œ0ä½æ˜¯ç©ºçš„ï¼Œå°±æ”¾åˆ°0å¤„ï¼Œå°†Entryçš„ä¸‹æ ‡entryIndexèµ‹å€¼ç»™bucketsä¸­å¯¹åº”ä¸‹æ ‡çš„bucketã€‚æ­¥éª¤3ä¸­æ˜¯å­˜æ”¾åœ¨entries[0]çš„ä½ç½®ï¼Œæ‰€ä»¥buckets[2]=0ã€‚   å“ˆå¸Œç¢°æ’ï¼šå°†æ–°åŠ å…¥çš„å…ƒç´ æ”¾è¿›entriesçš„ä¸‹ä¸€ä¸ªç©ºä½ï¼Œæ›´æ–°nextå’Œå“ˆå¸Œæ¡¶æŒ‡å‘çš„ç´¢å¼•ã€‚    åˆ é™¤çš„æ—¶å€™ï¼Œå¦‚æœå…ƒç´ åœ¨é“¾è¡¨ä¸­é—´ï¼Œå°±ä¼šè®©å‰ä¸€ä¸ªæŒ‡å‘åä¸€ä¸ªï¼Œç©ºå‡ºæ¥ä½ç½®çš„ç”¨freelistè®°å½•ï¼Œä¸‹ä¸€æ¬¡å¯ä»¥æ¥ç€ç”¨ã€‚ä¸è¿‡è¿™æ ·å°±æ‰“ä¹±äº†å€¼æ’å…¥çš„é¡ºåºã€‚  Hashæ¡¶ç®—æ³•è¯´åˆ°Hashç®—æ³•å¤§å®¶å°±ä¼šæƒ³åˆ°Hashè¡¨ï¼Œä¸€ä¸ªKeyé€šè¿‡Hashå‡½æ•°è¿ç®—åå¯å¿«é€Ÿçš„å¾—åˆ°hashCodeï¼Œé€šè¿‡hashCodeçš„æ˜ å°„å¯ç›´æ¥Get...</div></div></div></a><a class="pagination-related" href="/2023/07/30/%E7%9F%A5%E8%AF%86%E6%95%B4%E7%90%86-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" title="è®¾è®¡æ¨¡å¼-çŸ¥è¯†æ•´ç†"><img class="cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">ä¸‹ä¸€ç¯‡</div><div class="info-item-2">è®¾è®¡æ¨¡å¼-çŸ¥è¯†æ•´ç†</div></div><div class="info-2"><div class="info-item-1">ã€æ›´å¹¿æ³›çš„è®¾è®¡æ¨¡å¼åˆ†ç±»ã€‘è®¾è®¡æ¨¡å¼æ€»ç»“ä¹‹æ¨¡å¼åˆ†ç±»_è¿·æ­»ç‰¹å…”çš„åšå®¢-CSDNåšå®¢ æ¸¸æˆä¸­çš„è®¾è®¡æ¨¡å¼ - çŸ¥ä¹ (zhihu.com)  åˆ›å»ºå‹è®¾è®¡æ¨¡å¼ ç»“æ„å‹è®¾è®¡æ¨¡å¼ è¡Œä¸ºå‹è®¾è®¡æ¨¡å¼  å•ä¾‹æ¨¡å¼ã€åˆ›å»ºå‹ã€‘åˆ°åº•æ˜¯ç”¨â€é™æ€ç±»â€è¿˜æ˜¯å•ä¾‹ - æ˜é‡‘ (juejin.cn) ä»€ä¹ˆæ˜¯å•ä¾‹æ¨¡å¼å•ä¾‹æ¨¡å¼æŒ‡çš„æ˜¯åœ¨åº”ç”¨***æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…åªèƒ½å­˜åœ¨ä¸€ä¸ªå®ä¾‹ã€‚***å•ä¾‹æ¨¡å¼æ˜¯ä¸€ç§è¢«å¹¿æ³›ä½¿ç”¨çš„è®¾è®¡æ¨¡å¼ã€‚ ä»–æœ‰å¾ˆå¤šå¥½å¤„ï¼Œèƒ½å¤Ÿé¿å…å®ä¾‹å¯¹è±¡çš„é‡å¤åˆ›å»ºï¼Œå‡å°‘åˆ›å»ºå®ä¾‹çš„ç³»ç»Ÿå¼€é”€ï¼ŒèŠ‚çœå†…å­˜ã€‚  1.ä¸€ä¸ªç±»åªèƒ½æœ‰ä¸€ä¸ªå®ä¾‹ï¼›  2.è‡ªå·±åˆ›å»ºè¿™ä¸ªå®ä¾‹ï¼› 3.æ•´ä¸ªç³»ç»Ÿéƒ½è¦ä½¿ç”¨è¿™ä¸ªå®ä¾‹ã€‚ å®ç°æ–¹å¼ é¥¿æ±‰æ¨¡å¼  æ‰€è°“é¥¿æ±‰æ¨¡å¼å°±æ˜¯ç«‹å³åŠ è½½ï¼Œä¸€èˆ¬æƒ…å†µä¸‹å†è°ƒç”¨getInstancefæ–¹æ³•ä¹‹å‰å°±å·²ç»äº§ç”Ÿäº†å®ä¾‹ï¼Œä¹Ÿå°±æ˜¯åœ¨ç±»åŠ è½½çš„æ—¶å€™å·²ç»äº§ç”Ÿäº†ã€‚ è¿™ç§æ¨¡å¼çš„ç¼ºç‚¹å¾ˆæ˜æ˜¾ï¼Œå°±æ˜¯å ç”¨èµ„æºï¼Œå½“å•ä¾‹ç±»å¾ˆå¤§çš„æ—¶å€™ï¼Œå…¶å®æˆ‘ä»¬æ˜¯æƒ³ä½¿ç”¨çš„æ—¶å€™å†äº§ç”Ÿå®ä¾‹ã€‚å› æ­¤è¿™ç§æ–¹å¼é€‚åˆå ç”¨èµ„æºå°‘ï¼Œåœ¨åˆå§‹åŒ–çš„æ—¶å€™å°±ä¼šè¢«ç”¨åˆ°çš„ç±»ã€‚ 1234567891011class SingletonHungary &#123;    private static SingletonHungar...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/head_pic_3.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">(â—Ë‡âˆ€Ë‡â—)</div><div class="author-info-description">è¯¥åšå®¢æš‚æ—¶åœæ­¢ç»´æŠ¤ï¼Œæ–°åšå®¢ä¼ é€é—¨ï¼šhttps://juejin.cn/user/3598037753539256</div><div class="site-data"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">50</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Canvas"><span class="toc-number">1.</span> <span class="toc-text">Canvas</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%98%E5%88%B6%E5%85%83%E7%B4%A0%E9%A1%BA%E5%BA%8F"><span class="toc-number">1.1.</span> <span class="toc-text">ç»˜åˆ¶å…ƒç´ é¡ºåº</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B8%B2%E6%9F%93%E6%A8%A1%E5%BC%8F-Render-Modes"><span class="toc-number">1.2.</span> <span class="toc-text">æ¸²æŸ“æ¨¡å¼ Render Modes</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#UGUI%E5%92%8CNGUI%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">2.</span> <span class="toc-text">UGUIå’ŒNGUIçš„åŒºåˆ«</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#UGUI%E5%8E%9F%E7%90%86"><span class="toc-number">3.</span> <span class="toc-text">UGUIåŸç†</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6"><span class="toc-number">3.1.</span> <span class="toc-text">å›¾å½¢ç»˜åˆ¶</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E7%B1%BB%E8%AF%A6%E8%A7%A3"><span class="toc-number">3.2.</span> <span class="toc-text">åŸºç¡€ç±»è¯¦è§£</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%88%E6%89%B9%E8%BF%87%E7%A8%8B%EF%BC%88Canvases%EF%BC%89"><span class="toc-number">3.3.</span> <span class="toc-text">åˆæ‰¹è¿‡ç¨‹ï¼ˆCanvasesï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%90%88%E6%89%B9"><span class="toc-number">3.3.1.</span> <span class="toc-text">ä»€ä¹ˆæ˜¯åˆæ‰¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%88%E6%89%B9%E7%9A%84%E6%84%8F%E4%B9%89"><span class="toc-number">3.3.2.</span> <span class="toc-text">åˆæ‰¹çš„æ„ä¹‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%88%E6%89%B9%E8%A7%84%E5%88%99"><span class="toc-number">3.3.3.</span> <span class="toc-text">åˆæ‰¹è§„åˆ™</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E5%8C%96%E6%8A%80%E5%B7%A7"><span class="toc-number">3.3.4.</span> <span class="toc-text">ä¼˜åŒ–æŠ€å·§</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%87%8D%E7%BB%98%E8%BF%87%E7%A8%8B%EF%BC%88Graphics%EF%BC%89"><span class="toc-number">3.4.</span> <span class="toc-text">é‡ç»˜è¿‡ç¨‹ï¼ˆGraphicsï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%A7%E8%87%B4%E7%90%86%E8%A7%A3"><span class="toc-number">3.4.1.</span> <span class="toc-text">å¤§è‡´ç†è§£</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%93%E5%AD%98%E5%92%8C%E9%87%8D%E5%BB%BA%EF%BC%9ACanvasUpdateRegistry"><span class="toc-number">3.4.2.</span> <span class="toc-text">ç¼“å­˜å’Œé‡å»ºï¼šCanvasUpdateRegistry</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E7%BB%98%E8%A7%A6%E5%8F%91%E7%9A%84%E6%9D%A1%E4%BB%B6"><span class="toc-number">3.4.3.</span> <span class="toc-text">é‡ç»˜è§¦å‘çš„æ¡ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%83%E5%B1%80%E9%87%8D%E5%BB%BA%EF%BC%88%E8%AF%A6%E7%BB%86%EF%BC%89"><span class="toc-number">3.4.4.</span> <span class="toc-text">å¸ƒå±€é‡å»ºï¼ˆè¯¦ç»†ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E5%BD%A2%E9%87%8D%E5%BB%BA%EF%BC%88%E8%AF%A6%E7%BB%86%EF%BC%89"><span class="toc-number">3.4.5.</span> <span class="toc-text">å›¾å½¢é‡å»ºï¼ˆè¯¦ç»†ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E5%BB%BA%E6%80%BB%E7%BB%93"><span class="toc-number">3.4.6.</span> <span class="toc-text">é‡å»ºæ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B1%82%E7%BA%A7"><span class="toc-number">3.5.</span> <span class="toc-text">å±‚çº§</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A3%81%E5%89%AA"><span class="toc-number">3.6.</span> <span class="toc-text">è£å‰ª</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BE%E9%9B%86"><span class="toc-number">3.7.</span> <span class="toc-text">å›¾é›†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BE%93%E5%85%A5%E7%B3%BB%E7%BB%9F"><span class="toc-number">3.8.</span> <span class="toc-text">è¾“å…¥ç³»ç»Ÿ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">3.8.1.</span> <span class="toc-text">æ¦‚è¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EventSystem"><span class="toc-number">3.8.2.</span> <span class="toc-text">EventSystem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BE%93%E5%85%A5%E6%A8%A1%E5%9D%97-InputModule"><span class="toc-number">3.8.3.</span> <span class="toc-text">è¾“å…¥æ¨¡å—(InputModule)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%84%E7%BA%BF%E6%8A%95%E5%B0%84%E5%99%A8%EF%BC%88Raycaster%EF%BC%89"><span class="toc-number">3.8.4.</span> <span class="toc-text">å°„çº¿æŠ•å°„å™¨ï¼ˆRaycasterï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B6%88%E6%81%AF%E7%B3%BB%E7%BB%9F"><span class="toc-number">3.8.5.</span> <span class="toc-text">æ¶ˆæ¯ç³»ç»Ÿ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%84%E7%A7%8D%E6%94%AF%E6%8C%81%E7%9A%84%E4%BA%8B%E4%BB%B6"><span class="toc-number">3.8.6.</span> <span class="toc-text">å„ç§æ”¯æŒçš„äº‹ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E8%A7%A6%E5%8F%91%E5%99%A8-EventTrigger"><span class="toc-number">3.8.7.</span> <span class="toc-text">äº‹ä»¶è§¦å‘å™¨(EventTrigger)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UGUI%E7%9A%84%E4%BA%8B%E4%BB%B6%E4%BC%A0%E9%80%92"><span class="toc-number">3.9.</span> <span class="toc-text">UGUIçš„äº‹ä»¶ä¼ é€’</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/08/26/%E6%8A%80%E6%9C%AF%E5%91%A8%E6%8A%A520250826-%E7%BD%91%E7%BB%9C%E7%A7%BB%E5%8A%A8%E8%83%BD%E5%8A%9B%E7%9A%84%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/" title="æŠ€æœ¯å‘¨æŠ¥-ç½‘ç»œç§»åŠ¨èƒ½åŠ›çš„æœ€ä½³å®è·µ"><img src="https://cdn.jsdelivr.net/gh/huangxinhere/hexo_img/img/20250816163511_1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="æŠ€æœ¯å‘¨æŠ¥-ç½‘ç»œç§»åŠ¨èƒ½åŠ›çš„æœ€ä½³å®è·µ"/></a><div class="content"><a class="title" href="/2025/08/26/%E6%8A%80%E6%9C%AF%E5%91%A8%E6%8A%A520250826-%E7%BD%91%E7%BB%9C%E7%A7%BB%E5%8A%A8%E8%83%BD%E5%8A%9B%E7%9A%84%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/" title="æŠ€æœ¯å‘¨æŠ¥-ç½‘ç»œç§»åŠ¨èƒ½åŠ›çš„æœ€ä½³å®è·µ">æŠ€æœ¯å‘¨æŠ¥-ç½‘ç»œç§»åŠ¨èƒ½åŠ›çš„æœ€ä½³å®è·µ</a><time datetime="2025-08-25T16:00:00.000Z" title="å‘è¡¨äº 2025-08-26 00:00:00">2025-08-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/22/UE%E5%A4%9A%E4%BA%BA%E5%B0%84%E5%87%BBC++%EF%BC%881%EF%BC%89%E4%BA%92%E8%81%94%E7%BD%91%E8%81%94%E6%9C%BA%E8%AE%BE%E7%BD%AE/" title="UEä¸OnlineSubsystemSteamï¼ˆOSS Steamï¼‰"><img src="https://cdn.jsdelivr.net/gh/huangxinhere/hexo_img/img/20250822000958_1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="UEä¸OnlineSubsystemSteamï¼ˆOSS Steamï¼‰"/></a><div class="content"><a class="title" href="/2025/08/22/UE%E5%A4%9A%E4%BA%BA%E5%B0%84%E5%87%BBC++%EF%BC%881%EF%BC%89%E4%BA%92%E8%81%94%E7%BD%91%E8%81%94%E6%9C%BA%E8%AE%BE%E7%BD%AE/" title="UEä¸OnlineSubsystemSteamï¼ˆOSS Steamï¼‰">UEä¸OnlineSubsystemSteamï¼ˆOSS Steamï¼‰</a><time datetime="2025-08-21T16:00:00.000Z" title="å‘è¡¨äº 2025-08-22 00:00:00">2025-08-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/13/2024313-Unity-UI%EF%BC%882%EF%BC%89/" title="Unity-UIï¼ˆ2ï¼‰"><img src="/img/unity.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Unity-UIï¼ˆ2ï¼‰"/></a><div class="content"><a class="title" href="/2024/03/13/2024313-Unity-UI%EF%BC%882%EF%BC%89/" title="Unity-UIï¼ˆ2ï¼‰">Unity-UIï¼ˆ2ï¼‰</a><time datetime="2024-03-12T16:00:00.000Z" title="å‘è¡¨äº 2024-03-13 00:00:00">2024-03-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/09/14/%E7%9F%A5%E8%AF%86%E6%95%B4%E7%90%86-Unity-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" title="Unity-æ€§èƒ½ä¼˜åŒ–"><img src="/img/unity.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Unity-æ€§èƒ½ä¼˜åŒ–"/></a><div class="content"><a class="title" href="/2023/09/14/%E7%9F%A5%E8%AF%86%E6%95%B4%E7%90%86-Unity-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" title="Unity-æ€§èƒ½ä¼˜åŒ–">Unity-æ€§èƒ½ä¼˜åŒ–</a><time datetime="2023-09-13T16:00:00.000Z" title="å‘è¡¨äº 2023-09-14 00:00:00">2023-09-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/09/13/%E7%9F%A5%E8%AF%86%E6%95%B4%E7%90%86-Unity-%E5%9B%BE%E5%BD%A2/" title="Unity-å›¾å½¢"><img src="/img/unity.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Unity-å›¾å½¢"/></a><div class="content"><a class="title" href="/2023/09/13/%E7%9F%A5%E8%AF%86%E6%95%B4%E7%90%86-Unity-%E5%9B%BE%E5%BD%A2/" title="Unity-å›¾å½¢">Unity-å›¾å½¢</a><time datetime="2023-09-12T16:00:00.000Z" title="å‘è¡¨äº 2023-09-13 00:00:00">2023-09-13</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/unity.jpg);"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2025 By (â—Ë‡âˆ€Ë‡â—)</span><span class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.0-b3</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æ—¥é—´å’Œå¤œé—´æ¨¡å¼åˆ‡æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>